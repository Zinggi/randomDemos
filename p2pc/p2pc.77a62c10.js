parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"X+cO":[function(require,module,exports) {
var e={};e.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),e.useArrayBufferView=!e.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),module.exports.binaryFeatures=e;var r=module.exports.BlobBuilder;function t(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(r=module.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),t.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},t.prototype.flush=function(){if(this._pieces.length>0){var r=new Uint8Array(this._pieces);e.useArrayBufferView||(r=r.buffer),this._parts.push(r),this._pieces=[]}},t.prototype.getBuffer=function(){if(this.flush(),e.useBlobBuilder){for(var t=new r,i=0,u=this._parts.length;i<u;i++)t.append(this._parts[i]);return t.getBlob()}return new Blob(this._parts)},module.exports.BufferBuilder=t;
},{}],"J6D+":[function(require,module,exports) {
var t=require("./bufferbuilder").BufferBuilder,e=require("./bufferbuilder").binaryFeatures,i={unpack:function(t){return new r(t).unpack()},pack:function(t){var e=new n;return e.pack(t),e.getBuffer()}};function r(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function n(){this.bufferBuilder=new t}function u(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}function a(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,u).length}module.exports=i,r.prototype.unpack=function(){var t,e=this.unpack_uint8();if(e<128)return e;if((224^e)<32)return(224^e)-32;if((t=160^e)<=15)return this.unpack_raw(t);if((t=176^e)<=15)return this.unpack_string(t);if((t=144^e)<=15)return this.unpack_array(t);if((t=128^e)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}},r.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},r.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},r.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},r.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},r.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256},r.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536},r.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},r.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},r.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e},r.prototype.unpack_string=function(t){for(var e,i,r=this.read(t),n=0,u="";n<t;)(e=r[n])<128?(u+=String.fromCharCode(e),n++):(192^e)<32?(i=(192^e)<<6|63&r[n+1],u+=String.fromCharCode(i),n+=2):(i=(15&e)<<12|(63&r[n+1])<<6|63&r[n+2],u+=String.fromCharCode(i),n+=3);return this.index+=t,u},r.prototype.unpack_array=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.unpack();return e},r.prototype.unpack_map=function(t){for(var e={},i=0;i<t;i++){var r=this.unpack(),n=this.unpack();e[r]=n}return e},r.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=(t>>23&255)-127;return(0==t>>31?1:-1)*(8388607&t|8388608)*Math.pow(2,e-23)},r.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),i=(t>>20&2047)-1023;return(0==t>>31?1:-1)*((1048575&t|1048576)*Math.pow(2,i-20)+e*Math.pow(2,i-52))},r.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},n.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},n.prototype.pack=function(t){var i=typeof t;if("string"==i)this.pack_string(t);else if("number"==i)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"==i)!0===t?this.bufferBuilder.append(195):!1===t&&this.bufferBuilder.append(194);else if("undefined"==i)this.bufferBuilder.append(192);else{if("object"!=i)throw new Error('Type "'+i+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var r=t.constructor;if(r==Array)this.pack_array(t);else if(r==Blob||r==File)this.pack_bin(t);else if(r==ArrayBuffer)e.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)e.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(r==Object)this.pack_object(t);else if(r==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+r.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},n.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},n.prototype.pack_string=function(t){var e=a(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},n.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var i=0;i<e;i++)this.pack(t[i])},n.prototype.pack_integer=function(t){if(-32<=t&&t<=127)this.bufferBuilder.append(255&t);else if(0<=t&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(-128<=t&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(0<=t&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(-32768<=t&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(0<=t&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(-2147483648<=t&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(-0x8000000000000000<=t&&t<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(0<=t&&t<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},n.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var i=Math.floor(Math.log(t)/Math.LN2),r=t/Math.pow(2,i)-1,n=Math.floor(r*Math.pow(2,52)),u=Math.pow(2,32),a=e<<31|i+1023<<20|n/u&1048575,p=n%u;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(p)},n.prototype.pack_object=function(t){var e=Object.keys(t).length;if(e<=15)this.pack_uint8(128+e);else if(e<=65535)this.bufferBuilder.append(222),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(e)}for(var i in t)t.hasOwnProperty(i)&&(this.pack(i),this.pack(t[i]))},n.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},n.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},n.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),i=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&i)>>>24),this.bufferBuilder.append((16711680&i)>>>16),this.bufferBuilder.append((65280&i)>>>8),this.bufferBuilder.append(255&i)},n.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},n.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),i=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&i)>>>24),this.bufferBuilder.append((16711680&i)>>>16),this.bufferBuilder.append((65280&i)>>>8),this.bufferBuilder.append(255&i)};
},{"./bufferbuilder":"X+cO"}],"4DZb":[function(require,module,exports) {
module.exports.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,module.exports.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,module.exports.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate;
},{}],"zQTp":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3],n={iceServers:[{url:"stun:stun.l.google.com:19302"}]},r=1,o=require("js-binarypack"),t=require("./adapter").RTCPeerConnection,a={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:9e3,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(e){var n=parseInt(e,10);isNaN(parseInt(e,10))?a.logLevel=e?3:0:a.logLevel=n,a.log=a.warn=a.error=a.noop,a.logLevel>0&&(a.error=a._printWith("ERROR")),a.logLevel>1&&(a.warn=a._printWith("WARNING")),a.logLevel>2&&(a.log=a._print)},setLogFunction:function(e){e.constructor!==Function?a.warn("The log function you passed in is not a function. Defaulting to regular logs."):a._print=e},_printWith:function(e){return function(){var n=Array.prototype.slice.call(arguments);n.unshift(e),a._print.apply(a,n)}},_print:function(){var e=!1,n=Array.prototype.slice.call(arguments);n.unshift("PeerJS: ");for(var r=0,o=n.length;r<o;r++)n[r]instanceof Error&&(n[r]="("+n[r].name+") "+n[r].message,e=!0);e?console.error.apply(console,n):console.log.apply(console,n)},defaultConfig:n,browser:window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported",supports:function(){if(void 0===t)return{};var e,r,o=!0,a=!0,i=!1,c=!1,l=!!window.webkitRTCPeerConnection;try{e=new t(n,{optional:[{RtpDataChannels:!0}]})}catch(s){o=!1,a=!1}if(o)try{r=e.createDataChannel("_PEERJSTEST")}catch(s){o=!1}if(o){try{r.binaryType="blob",i=!0}catch(s){}var u=new t(n,{});try{c=u.createDataChannel("_PEERJSRELIABLETEST",{}).reliable}catch(s){}u.close()}return a&&(a=!!e.addStream),e&&e.close(),{audioVideo:a,data:o,binaryBlob:i,binary:c,reliable:c,sctp:c,onnegotiationneeded:l}}(),validateId:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},validateKey:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},debug:!1,inherits:function(e,n){e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e},pack:o.pack,unpack:o.unpack,log:function(){if(a.debug){var e=!1,n=Array.prototype.slice.call(arguments);n.unshift("PeerJS: ");for(var r=0,o=n.length;r<o;r++)n[r]instanceof Error&&(n[r]="("+n[r].name+") "+n[r].message,e=!0);e?console.error.apply(console,n):console.log.apply(console,n)}},setZeroTimeout:function(e){var n=[],r="zero-timeout-message";function o(o){o.source==e&&o.data==r&&(o.stopPropagation&&o.stopPropagation(),n.length&&n.shift()())}return e.addEventListener?e.addEventListener("message",o,!0):e.attachEvent&&e.attachEvent("onmessage",o),function(o){n.push(o),e.postMessage(r,"*")}}(window),chunk:function(e){for(var n=[],o=e.size,t=index=0,i=Math.ceil(o/a.chunkedMTU);t<o;){var c=Math.min(o,t+a.chunkedMTU),l=e.slice(t,c),u={__peerData:r,n:index,data:l,total:i};n.push(u),t=c,index+=1}return r+=1,n},blobToArrayBuffer:function(e,n){var r=new FileReader;r.onload=function(e){n(e.target.result)},r.readAsArrayBuffer(e)},blobToBinaryString:function(e,n){var r=new FileReader;r.onload=function(e){n(e.target.result)},r.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=255&e.charCodeAt(r);return n.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol}};module.exports=a;
},{"js-binarypack":"J6D+","./adapter":"4DZb"}],"LqgX":[function(require,module,exports) {
"use strict";function t(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function e(){}e.prototype._events=void 0,e.prototype.listeners=function(t){if(!this._events||!this._events[t])return[];if(this._events[t].fn)return[this._events[t].fn];for(var e=0,n=this._events[t].length,s=new Array(n);e<n;e++)s[e]=this._events[t][e].fn;return s},e.prototype.emit=function(t,e,n,s,r,i){if(!this._events||!this._events[t])return!1;var o,h,f=this._events[t],v=arguments.length;if("function"==typeof f.fn){switch(f.once&&this.removeListener(t,f.fn,!0),v){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,s),!0;case 5:return f.fn.call(f.context,e,n,s,r),!0;case 6:return f.fn.call(f.context,e,n,s,r,i),!0}for(h=1,o=new Array(v-1);h<v;h++)o[h-1]=arguments[h];f.fn.apply(f.context,o)}else{var c,a=f.length;for(h=0;h<a;h++)switch(f[h].once&&this.removeListener(t,f[h].fn,!0),v){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,e);break;case 3:f[h].fn.call(f[h].context,e,n);break;default:if(!o)for(c=1,o=new Array(v-1);c<v;c++)o[c-1]=arguments[c];f[h].fn.apply(f[h].context,o)}}return!0},e.prototype.on=function(e,n,s){var r=new t(n,s||this);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],r]:this._events[e].push(r):this._events[e]=r,this},e.prototype.once=function(e,n,s){var r=new t(n,s||this,!0);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],r]:this._events[e].push(r):this._events[e]=r,this},e.prototype.removeListener=function(t,e,n){if(!this._events||!this._events[t])return this;var s=this._events[t],r=[];if(e&&(s.fn&&(s.fn!==e||n&&!s.once)&&r.push(s),!s.fn))for(var i=0,o=s.length;i<o;i++)(s[i].fn!==e||n&&!s[i].once)&&r.push(s[i]);return r.length?this._events[t]=1===r.length?r[0]:r:delete this._events[t],this},e.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[t]:this._events={},this):this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prototype.setMaxListeners=function(){return this},e.EventEmitter=e,e.EventEmitter2=e,e.EventEmitter3=e,module.exports=e;
},{}],"F3Do":[function(require,module,exports) {
var t=require("./util"),e=require("eventemitter3");function s(t,i,o,n,r,h){if(!(this instanceof s))return new s(t,i,o,n,r,h);h=h||o,e.call(this),this.disconnected=!1,this._queue=[];var a=t?"https://":"http://",_=t?"wss://":"ws://";this._httpUrl=a+i+":"+o+n+r,this._wsUrl=_+i+":"+h+n+"peerjs?key="+r}t.inherits(s,e),s.prototype.start=function(t,e){this.id=t,this._httpUrl+="/"+t+"/"+e,this._wsUrl+="&id="+t+"&token="+e,this._startXhrStream(),this._startWebSocket()},s.prototype._startWebSocket=function(e){var s=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(e){try{var i=JSON.parse(e.data)}catch(o){return void t.log("Invalid server message",e.data)}s.emit("message",i)},this._socket.onclose=function(e){t.log("Socket closed."),s.disconnected=!0,s.emit("disconnected")},this._socket.onopen=function(){s._timeout&&(clearTimeout(s._timeout),setTimeout(function(){s._http.abort(),s._http=null},5e3)),s._sendQueuedMessages(),t.log("Socket open")})},s.prototype._startXhrStream=function(e){try{var s=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=e||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onerror=function(){clearTimeout(s._timeout),s.emit("disconnected")},this._http.onreadystatechange=function(){2==this.readyState&&this.old?(this.old.abort(),delete this.old):this.readyState>2&&200===this.status&&this.responseText&&s._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(i){t.log("XMLHttpRequest not available; defaulting to WebSockets")}},s.prototype._handleStream=function(e){var s=e.responseText.split("\n");if(e._buffer)for(;e._buffer.length>0;){var i=e._buffer.shift(),o=s[i];try{o=JSON.parse(o)}catch(r){e._buffer.shift(i);break}this.emit("message",o)}var n=s[e._index];if(n)if(e._index+=1,e._index===s.length)e._buffer||(e._buffer=[]),e._buffer.push(e._index-1);else{try{n=JSON.parse(n)}catch(r){return void t.log("Invalid server message",n)}this.emit("message",n)}},s.prototype._setHTTPTimeout=function(){var t=this;this._timeout=setTimeout(function(){var e=t._http;t._wsOpen()?e.abort():(t._startXhrStream(e._streamIndex+1),t._http.old=e)},25e3)},s.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},s.prototype._sendQueuedMessages=function(){for(var t=0,e=this._queue.length;t<e;t+=1)this.send(this._queue[t])},s.prototype.send=function(t){if(!this.disconnected)if(this.id)if(t.type){var e=JSON.stringify(t);if(this._wsOpen())this._socket.send(e);else{var s=new XMLHttpRequest,i=this._httpUrl+"/"+t.type.toLowerCase();s.open("post",i,!0),s.setRequestHeader("Content-Type","application/json"),s.send(e)}}else this.emit("error","Invalid message");else this._queue.push(t)},s.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)},module.exports=s;
},{"./util":"zQTp","eventemitter3":"LqgX"}],"l1nn":[function(require,module,exports) {
var e=require("./util"),t=require("./adapter").RTCPeerConnection,n=require("./adapter").RTCSessionDescription,o=require("./adapter").RTCIceCandidate,r={pcs:{data:{},media:{}},queue:[],_idPrefix:"pc_",startConnection:function(t,n){var o=r._getPeerConnection(t,n);if(t.pc=t.peerConnection=o,"media"===t.type&&n._stream&&o.addStream(n._stream),n.originator){if("data"===t.type){var i={};e.supports.sctp||(i={reliable:n.reliable});var a=o.createDataChannel(t.label,i);t.initialize(a)}r._makeOffer(t)}else r.handleSDP("OFFER",t,n.sdp)},_getPeerConnection:function(t,n){r.pcs[t.type]||e.error(t.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),r.pcs[t.type][t.peer]||(r.pcs[t.type][t.peer]={});var o;r.pcs[t.type][t.peer];return n.pc&&(o=r.pcs[t.type][t.peer][n.pc]),o&&"stable"===o.signalingState||(o=r._startPeerConnection(t)),o},_startPeerConnection:function(n){e.log("Creating RTCPeerConnection.");var o=r._idPrefix+e.randomToken(),i={};"data"!==n.type||e.supports.sctp?"media"===n.type&&(i={optional:[{DtlsSrtpKeyAgreement:!0}]}):i={optional:[{RtpDataChannels:!0}]};var a=new t(n.provider.options.config,i);return r.pcs[n.type][n.peer][o]=a,r._setupListeners(n,a,o),a},_setupListeners:function(t,n,o){var r=t.peer,i=t.id,a=t.provider;e.log("Listening for ICE candidates."),n.onicecandidate=function(n){n.candidate&&(e.log("Received ICE candidates for:",t.peer),a.socket.send({type:"CANDIDATE",payload:{candidate:n.candidate,type:t.type,connectionId:t.id},dst:r}))},n.oniceconnectionstatechange=function(){switch(n.iceConnectionState){case"failed":e.log("iceConnectionState is disconnected, closing connections to "+r),t.emit("error",new Error("Negotiation of connection to "+r+" failed.")),t.close();break;case"disconnected":e.log("iceConnectionState is disconnected, closing connections to "+r),t.close();break;case"completed":n.onicecandidate=e.noop}},n.onicechange=n.oniceconnectionstatechange,e.log("Listening for data channel"),n.ondatachannel=function(t){e.log("Received data channel");var n=t.channel;a.getConnection(r,i).initialize(n)},e.log("Listening for remote stream"),n.onaddstream=function(t){e.log("Received remote stream");var n=t.stream,o=a.getConnection(r,i);"media"===o.type&&o.addStream(n)}},cleanup:function(t){e.log("Cleaning up PeerConnection to "+t.peer);var n=t.pc;n&&(n.readyState&&"closed"!==n.readyState||"closed"!==n.signalingState)&&(n.close(),t.pc=null)},_makeOffer:function(t){var n=t.pc;n.createOffer(function(o){e.log("Created offer."),!e.supports.sctp&&"data"===t.type&&t.reliable&&(o.sdp=Reliable.higherBandwidthSDP(o.sdp)),n.setLocalDescription(o,function(){e.log("Set localDescription: offer","for:",t.peer),t.provider.socket.send({type:"OFFER",payload:{sdp:o,type:t.type,label:t.label,connectionId:t.id,reliable:t.reliable,serialization:t.serialization,metadata:t.metadata,browser:e.browser},dst:t.peer})},function(n){"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=n&&(t.provider.emitError("webrtc",n),e.log("Failed to setLocalDescription, ",n))})},function(n){t.provider.emitError("webrtc",n),e.log("Failed to createOffer, ",n)},t.options.constraints)},_makeAnswer:function(t){var n=t.pc;n.createAnswer(function(o){e.log("Created answer."),!e.supports.sctp&&"data"===t.type&&t.reliable&&(o.sdp=Reliable.higherBandwidthSDP(o.sdp)),n.setLocalDescription(o,function(){e.log("Set localDescription: answer","for:",t.peer),t.provider.socket.send({type:"ANSWER",payload:{sdp:o,type:t.type,connectionId:t.id,browser:e.browser},dst:t.peer})},function(n){t.provider.emitError("webrtc",n),e.log("Failed to setLocalDescription, ",n)})},function(n){t.provider.emitError("webrtc",n),e.log("Failed to create answer, ",n)})},handleSDP:function(t,o,i){i=new n(i);var a=o.pc;e.log("Setting remote description",i),a.setRemoteDescription(i,function(){e.log("Set remoteDescription:",t,"for:",o.peer),"OFFER"===t&&r._makeAnswer(o)},function(t){o.provider.emitError("webrtc",t),e.log("Failed to setRemoteDescription, ",t)})},handleCandidate:function(t,n){var r=n.candidate,i=n.sdpMLineIndex;t.pc.addIceCandidate(new o({sdpMLineIndex:i,candidate:r})),e.log("Added ICE candidate for:",t.peer)}};module.exports=r;
},{"./util":"zQTp","./adapter":"4DZb"}],"W/YE":[function(require,module,exports) {
var t=require("./util"),e=require("eventemitter3"),i=require("./negotiator");function s(a,o,n){if(!(this instanceof s))return new s(a,o,n);e.call(this),this.options=t.extend({},n),this.open=!1,this.type="media",this.peer=a,this.provider=o,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||s._idPrefix+t.randomToken(),this.localStream&&i.startConnection(this,{_stream:this.localStream,originator:!0})}t.inherits(s,e),s._idPrefix="mc_",s.prototype.addStream=function(e){t.log("Receiving stream",e),this.remoteStream=e,this.emit("stream",e)},s.prototype.handleMessage=function(e){var s=e.payload;switch(e.type){case"ANSWER":i.handleSDP(e.type,this,s.sdp),this.open=!0;break;case"CANDIDATE":i.handleCandidate(this,s.candidate);break;default:t.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},s.prototype.answer=function(e){if(this.localStream)t.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this.options._payload._stream=e,this.localStream=e,i.startConnection(this,this.options._payload);for(var s=this.provider._getMessages(this.id),a=0,o=s.length;a<o;a+=1)this.handleMessage(s[a]);this.open=!0}},s.prototype.close=function(){this.open&&(this.open=!1,i.cleanup(this),this.emit("close"))},module.exports=s;
},{"./util":"zQTp","eventemitter3":"LqgX","./negotiator":"l1nn"}],"rdQ2":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3],r=require("js-binarypack"),t={debug:!1,inherits:function(e,r){e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e},pack:r.pack,unpack:r.unpack,log:function(){if(t.debug){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.unshift("Reliable: "),console.log.apply(console,e)}},setZeroTimeout:function(e){var r=[],t="zero-timeout-message";function n(n){n.source==e&&n.data==t&&(n.stopPropagation&&n.stopPropagation(),r.length&&r.shift()())}return e.addEventListener?e.addEventListener("message",n,!0):e.attachEvent&&e.attachEvent("onmessage",n),function(n){r.push(n),e.postMessage(t,"*")}}(this),blobToArrayBuffer:function(e,r){var t=new FileReader;t.onload=function(e){r(e.target.result)},t.readAsArrayBuffer(e)},blobToBinaryString:function(e,r){var t=new FileReader;t.onload=function(e){r(e.target.result)},t.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=255&e.charCodeAt(t);return r.buffer},randomToken:function(){return Math.random().toString(36).substr(2)}};module.exports=t;
},{"js-binarypack":"J6D+"}],"k+rQ":[function(require,module,exports) {
var t=require("./util");function e(n,i){if(!(this instanceof e))return new e(n);this._dc=n,t.debug=i,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],this._setupDC()}e.prototype.send=function(e){var n=t.pack(e);n.size<this._mtu?this._handleSend(["no",n]):(this._outgoing[this._count]={ack:0,chunks:this._chunk(n)},t.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),this._count+=1)},e.prototype._setupInterval=function(){var t=this;this._timeout=setInterval(function(){var e=t._queue.shift();if(e._multiple)for(var n=0,i=e.length;n<i;n+=1)t._intervalSend(e[n]);else t._intervalSend(e)},this._interval)},e.prototype._intervalSend=function(e){var n=this;e=t.pack(e),t.blobToBinaryString(e,function(t){n._dc.send(t)}),0===n._queue.length&&(clearTimeout(n._timeout),n._timeout=null)},e.prototype._processAcks=function(){for(var t in this._outgoing)this._outgoing.hasOwnProperty(t)&&this._sendWindowedChunks(t)},e.prototype._handleSend=function(t){for(var e=!0,n=0,i=this._queue.length;n<i;n+=1){var o=this._queue[n];o===t?e=!1:o._multiple&&-1!==o.indexOf(t)&&(e=!1)}e&&(this._queue.push(t),this._timeout||this._setupInterval())},e.prototype._setupDC=function(){var e=this;this._dc.onmessage=function(n){var i=n.data;if(i.constructor===String){var o=t.binaryStringToArrayBuffer(i);i=t.unpack(o),e._handleMessage(i)}}},e.prototype._handleMessage=function(e){var n,i=e[1],o=this._incoming[i],s=this._outgoing[i];switch(e[0]){case"no":var a=i;a&&this.onmessage(t.unpack(a));break;case"end":if(n=o,this._received[i]=e[2],!n)break;this._ack(i);break;case"ack":if(n=s){var h=e[2];n.ack=Math.max(h,n.ack),n.ack>=n.chunks.length?(t.log("Time: ",new Date-n.timer),delete this._outgoing[i]):this._processAcks()}break;case"chunk":if(!(n=o)){if(!0===this._received[i])break;n={ack:["ack",i,0],chunks:[]},this._incoming[i]=n}var r=e[2],u=e[3];n.chunks[r]=new Uint8Array(u),r===n.ack[2]&&this._calculateNextAck(i),this._ack(i);break;default:this._handleSend(e)}},e.prototype._chunk=function(e){for(var n=[],i=e.size,o=0;o<i;){var s=Math.min(i,o+this._mtu),a={payload:e.slice(o,s)};n.push(a),o=s}return t.log("Created",n.length,"chunks."),n},e.prototype._ack=function(t){var e=this._incoming[t].ack;this._received[t]===e[2]&&(this._complete(t),this._received[t]=!0),this._handleSend(e)},e.prototype._calculateNextAck=function(t){for(var e=this._incoming[t],n=e.chunks,i=0,o=n.length;i<o;i+=1)if(void 0===n[i])return void(e.ack[2]=i);e.ack[2]=n.length},e.prototype._sendWindowedChunks=function(e){t.log("sendWindowedChunks for: ",e);for(var n=this._outgoing[e],i=n.chunks,o=[],s=Math.min(n.ack+this._window,i.length),a=n.ack;a<s;a+=1)i[a].sent&&a!==n.ack||(i[a].sent=!0,o.push(["chunk",e,a,i[a].payload]));n.ack+this._window>=i.length&&o.push(["end",e,i.length]),o._multiple=!0,this._handleSend(o)},e.prototype._complete=function(e){t.log("Completed called for",e);var n=this,i=this._incoming[e].chunks,o=new Blob(i);t.blobToArrayBuffer(o,function(e){n.onmessage(t.unpack(e))}),delete this._incoming[e]},e.higherBandwidthSDP=function(t){var e=navigator.appVersion.match(/Chrome\/(.*?) /);if(e&&(e=parseInt(e[1].split(".").shift()))<31){var n=t.split("b=AS:30");if(n.length>1)return n[0]+"b=AS:102400"+n[1]}return t},e.prototype.onmessage=function(t){},module.exports.Reliable=e;
},{"./util":"rdQ2"}],"m5AI":[function(require,module,exports) {
var e=require("./util"),t=require("eventemitter3"),i=require("./negotiator"),n=require("reliable");function s(n,r,a){if(!(this instanceof s))return new s(n,r,a);t.call(this),this.options=e.extend({serialization:"binary",reliable:!1},a),this.open=!1,this.type="data",this.peer=n,this.provider=r,this.id=this.options.connectionId||s._idPrefix+e.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),i.startConnection(this,this.options._payload||{originator:!0})}e.inherits(s,t),s._idPrefix="dc_",s.prototype.initialize=function(e){this._dc=this.dataChannel=e,this._configureDataChannel()},s.prototype._configureDataChannel=function(){var t=this;e.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){e.log("Data channel connection success"),t.open=!0,t.emit("open")},!e.supports.sctp&&this.reliable&&(this._reliable=new n(this._dc,e.debug)),this._reliable?this._reliable.onmessage=function(e){t.emit("data",e)}:this._dc.onmessage=function(e){t._handleDataMessage(e)},this._dc.onclose=function(i){e.log("DataChannel closed for:",t.peer),t.close()}},s.prototype._handleDataMessage=function(t){var i=this,n=t.data,s=n.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(s===Blob)return void e.blobToArrayBuffer(n,function(t){n=e.unpack(t),i.emit("data",n)});if(s===ArrayBuffer)n=e.unpack(n);else if(s===String){var r=e.binaryStringToArrayBuffer(n);n=e.unpack(r)}}else"json"===this.serialization&&(n=JSON.parse(n));if(n.__peerData){var a=n.__peerData,o=this._chunkedData[a]||{data:[],count:0,total:n.total};return o.data[n.n]=n.data,o.count+=1,o.total===o.count&&(delete this._chunkedData[a],n=new Blob(o.data),this._handleDataMessage({data:n})),void(this._chunkedData[a]=o)}this.emit("data",n)},s.prototype.close=function(){this.open&&(this.open=!1,i.cleanup(this),this.emit("close"))},s.prototype.send=function(t,i){if(this.open)if(this._reliable)this._reliable.send(t);else{var n=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(t));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var s=e.pack(t);if((e.chunkedBrowsers[this._peerBrowser]||e.chunkedBrowsers[e.browser])&&!i&&s.size>e.chunkedMTU)return void this._sendChunks(s);e.supports.sctp?e.supports.binaryBlob?this._bufferedSend(s):e.blobToArrayBuffer(s,function(e){n._bufferedSend(e)}):e.blobToBinaryString(s,function(e){n._bufferedSend(e)})}else this._bufferedSend(t)}else this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."))},s.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this.bufferSize=this._buffer.length)},s.prototype._trySend=function(e){try{this._dc.send(e)}catch(i){this._buffering=!0;var t=this;return setTimeout(function(){t._buffering=!1,t._tryBuffer()},100),!1}return!0},s.prototype._tryBuffer=function(){if(0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},s.prototype._sendChunks=function(t){for(var i=e.chunk(t),n=0,s=i.length;n<s;n+=1){t=i[n];this.send(t,!0)}},s.prototype.handleMessage=function(t){var n=t.payload;switch(t.type){case"ANSWER":this._peerBrowser=n.browser,i.handleSDP(t.type,this,n.sdp);break;case"CANDIDATE":i.handleCandidate(this,n.candidate);break;default:e.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},module.exports=s;
},{"./util":"zQTp","eventemitter3":"LqgX","./negotiator":"l1nn","reliable":"k+rQ"}],"L0SA":[function(require,module,exports) {
var e=require("./util"),t=require("eventemitter3"),o=require("./socket"),n=require("./mediaconnection"),i=require("./dataconnection");function s(o,n){if(!(this instanceof s))return new s(o,n);t.call(this),o&&o.constructor==Object?(n=o,o=void 0):o&&(o=o.toString()),(n=e.extend({debug:0,host:e.CLOUD_HOST,port:e.CLOUD_PORT,path:"/",token:e.randomToken(),config:e.defaultConfig},n)).key="peerjs",this.options=n,"/"===n.host&&(n.host=window.location.hostname),"/"!==n.path[0]&&(n.path="/"+n.path),"/"!==n.path[n.path.length-1]&&(n.path+="/"),void 0===n.secure&&n.host!==e.CLOUD_HOST&&(n.secure=e.isSecure()),n.logFunction&&e.setLogFunction(n.logFunction),e.setLogLevel(n.debug),e.supports.audioVideo||e.supports.data?e.validateId(o)?(this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={},this._initializeServerConnection(),o?this._initialize(o):this._retrieveId()):this._delayedAbort("invalid-id",'ID "'+o+'" is invalid'):this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")}e.inherits(s,t),s.prototype._initializeServerConnection=function(){var e=this;this.socket=new o(this.options.secure,this.options.host,this.options.port,this.options.path,this.options.key,this.options.wsport),this.socket.on("message",function(t){e._handleMessage(t)}),this.socket.on("error",function(t){e._abort("socket-error",t)}),this.socket.on("disconnected",function(){e.disconnected||(e.emitError("network","Lost connection to server."),e.disconnect())}),this.socket.on("close",function(){e.disconnected||e._abort("socket-closed","Underlying socket is already closed.")})},s.prototype._retrieveId=function(t){var o=this,n=new XMLHttpRequest,i=(this.options.secure?"https://":"http://")+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/id";i+="?ts="+(new Date).getTime()+Math.random(),n.open("get",i,!0),n.onerror=function(t){e.error("Error retrieving ID",t);var n="";"/"===o.options.path&&o.options.host!==e.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),o._abort("server-error","Could not get an ID from the server."+n)},n.onreadystatechange=function(){4===n.readyState&&(200===n.status?o._initialize(n.responseText):n.onerror())},n.send(null)},s.prototype._initialize=function(e){this.id=e,this.socket.start(this.id,this.options.token)},s.prototype._handleMessage=function(t){var o,s=t.type,r=t.payload,a=t.src;switch(s){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",r.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":e.log("Received leave message from",a),this._cleanupPeer(a);break;case"EXPIRE":this.emitError("peer-unavailable","Could not connect to peer "+a);break;case"OFFER":var c=r.connectionId;if((o=this.getConnection(a,c))&&(o.close(),e.warn("Offer received for existing Connection ID:",c)),"media"===r.type)o=new n(a,this,{connectionId:c,_payload:r,metadata:r.metadata}),this._addConnection(a,o),this.emit("call",o);else{if("data"!==r.type)return void e.warn("Received malformed connection type:",r.type);o=new i(a,this,{connectionId:c,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable}),this._addConnection(a,o),this.emit("connection",o)}for(var h=this._getMessages(c),d=0,l=h.length;d<l;d+=1)o.handleMessage(h[d]);break;default:if(!r)return void e.warn("You received a malformed message from "+a+" of type "+s);var p=r.connectionId;(o=this.getConnection(a,p))&&o.pc?o.handleMessage(t):p?this._storeMessage(p,t):e.warn("You received an unrecognized message:",t)}},s.prototype._storeMessage=function(e,t){this._lostMessages[e]||(this._lostMessages[e]=[]),this._lostMessages[e].push(t)},s.prototype._getMessages=function(e){var t=this._lostMessages[e];return t?(delete this._lostMessages[e],t):[]},s.prototype.connect=function(t,o){if(this.disconnected)return e.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");var n=new i(t,this,o);return this._addConnection(t,n),n},s.prototype.call=function(t,o,i){if(this.disconnected)return e.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(o){(i=i||{})._stream=o;var s=new n(t,this,i);return this._addConnection(t,s),s}e.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},s.prototype._addConnection=function(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t)},s.prototype.getConnection=function(e,t){var o=this.connections[e];if(!o)return null;for(var n=0,i=o.length;n<i;n++)if(o[n].id===t)return o[n];return null},s.prototype._delayedAbort=function(t,o){var n=this;e.setZeroTimeout(function(){n._abort(t,o)})},s.prototype._abort=function(t,o){e.error("Aborting!"),this._lastServerId?this.disconnect():this.destroy(),this.emitError(t,o)},s.prototype.emitError=function(t,o){e.error("Error:",o),"string"==typeof o&&(o=new Error(o)),o.type=t,this.emit("error",o)},s.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},s.prototype._cleanup=function(){if(this.connections)for(var e=Object.keys(this.connections),t=0,o=e.length;t<o;t++)this._cleanupPeer(e[t]);this.emit("close")},s.prototype._cleanupPeer=function(e){for(var t=this.connections[e],o=0,n=t.length;o<n;o+=1)t[o].close()},s.prototype.disconnect=function(){var t=this;e.setZeroTimeout(function(){t.disconnected||(t.disconnected=!0,t.open=!1,t.socket&&t.socket.close(),t.emit("disconnected",t.id),t._lastServerId=t.id,t.id=null)})},s.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)e.log("Attempting reconnection to server with ID "+this._lastServerId),this.disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");e.error("In a hurry? We're still trying to make the initial connection!")}},s.prototype.listAllPeers=function(t){t=t||function(){};var o=this,n=new XMLHttpRequest,i=(this.options.secure?"https://":"http://")+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/peers";i+="?ts="+(new Date).getTime()+Math.random(),n.open("get",i,!0),n.onerror=function(e){o._abort("server-error","Could not get peers from the server."),t([])},n.onreadystatechange=function(){if(4===n.readyState){if(401===n.status){var i="";throw i=o.options.host!==e.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",t([]),new Error("It doesn't look like you have permission to list peers IDs. "+i)}200!==n.status?t([]):t(JSON.parse(n.responseText))}},n.send(null)},module.exports=s;
},{"./util":"zQTp","eventemitter3":"LqgX","./socket":"F3Do","./mediaconnection":"W/YE","./dataconnection":"m5AI"}],"5lnN":[function(require,module,exports) {
function n(r){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(r)}!function(r){"use strict";function t(n,r,t){return t.a=n,t.f=r,t}function e(n){return t(2,n,function(r){return function(t){return n(r,t)}})}function u(n){return t(3,n,function(r){return function(t){return function(e){return n(r,t,e)}}})}function i(n){return t(4,n,function(r){return function(t){return function(e){return function(u){return n(r,t,e,u)}}}})}function o(n){return t(5,n,function(r){return function(t){return function(e){return function(u){return function(i){return n(r,t,e,u,i)}}}}})}function a(n){return t(6,n,function(r){return function(t){return function(e){return function(u){return function(i){return function(o){return n(r,t,e,u,i,o)}}}}}})}function f(n){return t(7,n,function(r){return function(t){return function(e){return function(u){return function(i){return function(o){return function(a){return n(r,t,e,u,i,o,a)}}}}}}})}function c(n){return t(8,n,function(r){return function(t){return function(e){return function(u){return function(i){return function(o){return function(a){return function(f){return n(r,t,e,u,i,o,a,f)}}}}}}}})}function v(n){return t(9,n,function(r){return function(t){return function(e){return function(u){return function(i){return function(o){return function(a){return function(f){return function(c){return n(r,t,e,u,i,o,a,f,c)}}}}}}}}})}function s(n,r,t){return 2===n.a?n.f(r,t):n(r)(t)}function l(n,r,t,e){return 3===n.a?n.f(r,t,e):n(r)(t)(e)}function d(n,r,t,e,u){return 4===n.a?n.f(r,t,e,u):n(r)(t)(e)(u)}function b(n,r,t,e,u,i){return 5===n.a?n.f(r,t,e,u,i):n(r)(t)(e)(u)(i)}function h(n,r,t,e,u,i,o){return 6===n.a?n.f(r,t,e,u,i,o):n(r)(t)(e)(u)(i)(o)}console.warn("Compiled in DEV mode. Follow the advice at https://elm-lang.org/0.19.0/optimize for better performance and smaller assets.");var g=u(function(n,r,t){for(var e=new Array(n),u=0;u<n;u++)e[u]=t(r+u);return e}),p=e(function(n,r){for(var t=new Array(n),e=0;e<n&&r.b;e++)t[e]=r.a,r=r.b;return t.length=e,P(t,r)}),m=e(function(n,r){return r[n]}),$=u(function(n,r,t){for(var e=t.length,u=new Array(e),i=0;i<e;i++)u[i]=t[i];return u[n]=r,u}),y=e(function(n,r){for(var t=r.length,e=new Array(t+1),u=0;u<t;u++)e[u]=r[u];return e[t]=n,e}),w=(u(function(n,r,t){for(var e=t.length,u=0;u<e;u++)r=s(n,t[u],r);return r}),u(function(n,r,t){for(var e=t.length-1;e>=0;e--)r=s(n,t[e],r);return r})),S=(e(function(n,r){for(var t=r.length,e=new Array(t),u=0;u<t;u++)e[u]=n(r[u]);return e}),u(function(n,r,t){for(var e=t.length,u=new Array(e),i=0;i<e;i++)u[i]=s(n,r+i,t[i]);return u}),u(function(n,r,t){return t.slice(n,r)})),k=u(function(n,r,t){var e=r.length,u=n-e;u>t.length&&(u=t.length);for(var i=new Array(e+u),o=0;o<e;o++)i[o]=r[o];for(o=0;o<u;o++)i[o+e]=t[o];return i});e(function(n,r){return r}),e(function(n,r){return console.log(n+": "+N(r)),r});function N(r){return function r(t,e){if("function"==typeof e)return I(t,"<function>");if("boolean"==typeof e)return M(t,e?"True":"False");if("number"==typeof e)return function(n,r){return n?"[95m"+r+"[0m":r}(t,e+"");if(e instanceof String)return function(n,r){return n?"[92m"+r+"[0m":r}(t,"'"+L(e,!0)+"'");if("string"==typeof e)return T(t,'"'+L(e,!1)+'"');if("object"===n(e)&&"$"in e){var u=e.$;if("number"==typeof u)return I(t,"<internals>");if("#"===u[0]){var i=[];for(var o in e)"$"!==o&&i.push(r(t,e[o]));return"("+i.join(",")+")"}if("Set_elm_builtin"===u)return M(t,"Set")+A(t,".fromList")+" "+r(t,bt(e));if("RBNode_elm_builtin"===u||"RBEmpty_elm_builtin"===u)return M(t,"Dict")+A(t,".fromList")+" "+r(t,dt(e));if("Array_elm_builtin"===u)return M(t,"Array")+A(t,".fromList")+" "+r(t,vt(e));if("::"===u||"[]"===u){var i="[";for(e.b&&(i+=r(t,e.a),e=e.b);e.b;e=e.b)i+=","+r(t,e.a);return i+"]"}var i="";for(var a in e)if("$"!==a){var f=r(t,e[a]),c=f[0],v="{"===c||"("===c||"["===c||"<"===c||'"'===c||f.indexOf(" ")<0;i+=" "+(v?f:"("+f+")")}return M(t,u)+i}if("function"==typeof DataView&&e instanceof DataView)return T(t,"<"+e.byteLength+" bytes>");if("function"==typeof File&&e instanceof File)return I(t,"<"+e.name+">");if("object"===n(e)){var i=[];for(var s in e){var l="_"===s[0]?s.slice(1):s;i.push(A(t,l)+" = "+r(t,e[s]))}return 0===i.length?"{}":"{ "+i.join(", ")+" }"}return I(t,"<internals>")}(!1,r)}function L(n,r){var t=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return r?t.replace(/\'/g,"\\'"):t.replace(/\"/g,'\\"')}function M(n,r){return n?"[96m"+r+"[0m":r}function T(n,r){return n?"[93m"+r+"[0m":r}function A(n,r){return n?"[37m"+r+"[0m":r}function I(n,r){return n?"[94m"+r+"[0m":r}function O(n,r,t,e,u){switch(n){case 0:throw new Error('What node should I take over? In JavaScript I need something like:\n\n    Elm.Main.init({\n        node: document.getElementById("elm-node")\n    })\n\nYou need to do this with any Browser.sandbox or Browser.element program.');case 1:throw new Error("Browser.application programs cannot handle URLs like this:\n\n    "+document.location.href+"\n\nWhat is the root? The root of your file system? Try looking at this program with `elm reactor` or some other server.");case 2:throw new Error("Problem with the flags given to your Elm program on initialization.\n\n"+r);case 3:var i=r;throw new Error("There can only be one port named `"+i+"`, but your program has multiple.");case 4:i=r;throw new Error("Trying to send an unexpected type of value through port `"+i+"`:\n"+t);case 5:throw new Error('Trying to use `(==)` on functions.\nThere is no way to know if functions are "the same" in the Elm sense.\nRead more about this at https://package.elm-lang.org/packages/elm/core/latest/Basics#== which describes why it is this way and what the better version will look like.');case 6:var o=r;throw new Error("Your page is loading multiple Elm scripts with a module named "+o+". Maybe a duplicate script is getting loaded accidentally? If not, rename one of them so I know which is which!");case 8:o=r;var a=t,f=e;throw new Error("TODO in module `"+o+"` "+_(a)+"\n\n"+f);case 9:o=r,a=t;var c=e;f=u;throw new Error("TODO in module `"+o+"` from the `case` expression "+_(a)+"\n\nIt received the following value:\n\n    "+N(c).replace("\n","\n    ")+"\n\nBut the branch that handles it says:\n\n    "+f.replace("\n","\n    "));case 10:throw new Error("Bug in https://github.com/elm/virtual-dom/issues");case 11:throw new Error("Cannot perform mod 0. Division by zero error.")}}function _(n){return n.start.line===n.end.line?"on line "+n.start.line:"on lines "+n.start.line+" through "+n.end.line}function C(n,r){for(var t,e=[],u=E(n,r,0,e);u&&(t=e.pop());u=E(t.a,t.b,0,e));return u}function E(r,t,e,u){if(e>100)return u.push(P(r,t)),!0;if(r===t)return!0;if("object"!==n(r)||null===r||null===t)return"function"==typeof r&&O(5),!1;for(var i in"Set_elm_builtin"===r.$&&(r=bt(r),t=bt(t)),"RBNode_elm_builtin"!==r.$&&"RBEmpty_elm_builtin"!==r.$||(r=dt(r),t=dt(t)),r)if(!E(r[i],t[i],e+1,u))return!1;return!0}var R=e(C);e(function(n,r){return!C(n,r)});function j(r,t,e){if("object"!==n(r))return r===t?0:r<t?-1:1;if(r instanceof String){var u=r.valueOf(),i=t.valueOf();return u===i?0:u<i?-1:1}if("#"===r.$[0])return(e=j(r.a,t.a))?e:(e=j(r.b,t.b))?e:j(r.c,t.c);for(;r.b&&t.b&&!(e=j(r.a,t.a));r=r.b,t=t.b);return e||(r.b?1:t.b?-1:0)}e(function(n,r){return j(n,r)<0}),e(function(n,r){return j(n,r)<1}),e(function(n,r){return j(n,r)>0}),e(function(n,r){return j(n,r)>=0}),e(function(n,r){var t=j(n,r);return t<0?ot:t?st:it});var q={$:"#0"};function P(n,r){return{$:"#2",a:n,b:r}}function x(n,r,t){return{$:"#3",a:n,b:r,c:t}}function B(n){return new String(n)}function z(n,r){var t={};for(var e in n)t[e]=n[e];for(var e in r)t[e]=r[e];return t}e(F);function F(n,r){if("string"==typeof n)return n+r;if(!n.b)return r;var t=D(n.a,r);n=n.b;for(var e=t;n.b;n=n.b)e=e.b=D(n.a,r);return t}var J={$:"[]"};function D(n,r){return{$:"::",a:n,b:r}}var K=e(D);function G(n){for(var r=J,t=n.length;t--;)r=D(n[t],r);return r}function Q(n){for(var r=[];n.b;n=n.b)r.push(n.a);return r}var U=u(function(n,r,t){for(var e=[];r.b&&t.b;r=r.b,t=t.b)e.push(s(n,r.a,t.a));return G(e)}),Y=(i(function(n,r,t,e){for(var u=[];r.b&&t.b&&e.b;r=r.b,t=t.b,e=e.b)u.push(l(n,r.a,t.a,e.a));return G(u)}),o(function(n,r,t,e,u){for(var i=[];r.b&&t.b&&e.b&&u.b;r=r.b,t=t.b,e=e.b,u=u.b)i.push(d(n,r.a,t.a,e.a,u.a));return G(i)}),a(function(n,r,t,e,u,i){for(var o=[];r.b&&t.b&&e.b&&u.b&&i.b;r=r.b,t=t.b,e=e.b,u=u.b,i=i.b)o.push(b(n,r.a,t.a,e.a,u.a,i.a));return G(o)}),e(function(n,r){return G(Q(r).sort(function(r,t){return j(n(r),n(t))}))}),e(function(n,r){return G(Q(r).sort(function(r,t){var e=s(n,r,t);return e===it?0:e===ot?-1:1}))}),e(function(n,r){return n+r}),e(function(n,r){return n-r}),e(function(n,r){return n*r}),e(function(n,r){return n/r}),e(function(n,r){return n/r|0}),e(Math.pow),e(function(n,r){return r%n}),e(function(n,r){var t=r%n;return 0===n?O(11):t>0&&n<0||t<0&&n>0?t+n:t}));Math.PI,Math.E,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,e(Math.atan2);var W=Math.ceil,V=Math.floor,H=(Math.round,Math.sqrt,Math.log);isNaN;e(function(n,r){return n&&r}),e(function(n,r){return n||r}),e(function(n,r){return n!==r}),e(function(n,r){return n&r});var X=e(function(n,r){return n|r}),Z=e(function(n,r){return n^r});e(function(n,r){return r<<n}),e(function(n,r){return r>>n}),e(function(n,r){return r>>>n});var nn=e(function(n,r){return n+r});e(function(n,r){return n+r});e(function(n,r){for(var t=r.length,e=new Array(t),u=0;u<t;){var i=r.charCodeAt(u);55296<=i&&i<=56319?(e[u]=n(B(r[u]+r[u+1])),u+=2):(e[u]=n(B(r[u])),u++)}return e.join("")});var rn=e(function(n,r){for(var t=[],e=r.length,u=0;u<e;){var i=r[u],o=r.charCodeAt(u);u++,55296<=o&&o<=56319&&(i+=r[u],u++),n(B(i))&&t.push(i)}return t.join("")});u(function(n,r,t){for(var e=t.length,u=0;u<e;){var i=t[u],o=t.charCodeAt(u);u++,55296<=o&&o<=56319&&(i+=t[u],u++),r=s(n,B(i),r)}return r});var tn=u(function(n,r,t){for(var e=t.length;e--;){var u=t[e],i=t.charCodeAt(e);56320<=i&&i<=57343&&(u=t[--e]+u),r=s(n,B(u),r)}return r}),en=e(function(n,r){return r.split(n)}),un=e(function(n,r){return r.join(n)}),on=u(function(n,r,t){return t.slice(n,r)});e(function(n,r){for(var t=r.length;t--;){var e=r[t],u=r.charCodeAt(t);if(56320<=u&&u<=57343&&(e=r[--t]+e),n(B(e)))return!0}return!1});var an=e(function(n,r){for(var t=r.length;t--;){var e=r[t],u=r.charCodeAt(t);if(56320<=u&&u<=57343&&(e=r[--t]+e),!n(B(e)))return!1}return!0}),fn=e(function(n,r){return r.indexOf(n)>-1}),cn=(e(function(n,r){return 0===r.indexOf(n)}),e(function(n,r){return r.length>=n.length&&r.lastIndexOf(n)===r.length-n.length}),e(function(n,r){var t=n.length;if(t<1)return J;for(var e=0,u=[];(e=r.indexOf(n,e))>-1;)u.push(e),e+=t;return G(u)}));function vn(n){return n+""}function sn(n){return{$:2,b:n}}sn(function(n){return"number"!=typeof n?Nn("an INT",n):-2147483647<n&&n<2147483647&&(0|n)===n?wu(n):!isFinite(n)||n%1?Nn("an INT",n):wu(n)}),sn(function(n){return"boolean"==typeof n?wu(n):Nn("a BOOL",n)}),sn(function(n){return"number"==typeof n?wu(n):Nn("a FLOAT",n)});var ln=sn(function(n){return wu(An(n))}),dn=sn(function(n){return"string"==typeof n?wu(n):n instanceof String?wu(n+""):Nn("a STRING",n)});var bn=e(function(n,r){return{$:6,d:n,b:r}});e(function(n,r){return{$:7,e:n,b:r}});function hn(n,r){return{$:9,f:n,g:r}}var gn=e(function(n,r){return{$:10,b:r,h:n}});var pn=e(function(n,r){return hn(n,[r])}),mn=u(function(n,r,t){return hn(n,[r,t])}),$n=(i(function(n,r,t,e){return hn(n,[r,t,e])}),o(function(n,r,t,e,u){return hn(n,[r,t,e,u])}),a(function(n,r,t,e,u,i){return hn(n,[r,t,e,u,i])}),f(function(n,r,t,e,u,i,o){return hn(n,[r,t,e,u,i,o])}),c(function(n,r,t,e,u,i,o,a){return hn(n,[r,t,e,u,i,o,a])}),v(function(n,r,t,e,u,i,o,a,f){return hn(n,[r,t,e,u,i,o,a,f])}),e(function(n,r){try{return yn(n,JSON.parse(r))}catch(t){return yu(s(ku,"This is not valid JSON! "+t.message,An(r)))}}),e(function(n,r){return yn(n,In(r))}));function yn(r,t){switch(r.$){case 2:return r.b(t);case 5:return null===t?wu(r.c):Nn("null",t);case 3:return Sn(t)?wn(r.b,t,G):Nn("a LIST",t);case 4:return Sn(t)?wn(r.b,t,kn):Nn("an ARRAY",t);case 6:var e=r.d;if("object"!==n(t)||null===t||!(e in t))return Nn("an OBJECT with a field named `"+e+"`",t);var u=yn(r.b,t[e]);return Su(u)?u:yu(s(Nu,e,u.a));case 7:var i=r.e;if(!Sn(t))return Nn("an ARRAY",t);if(i>=t.length)return Nn("a LONGER array. Need index "+i+" but only see "+t.length+" entries",t);u=yn(r.b,t[i]);return Su(u)?u:yu(s(Lu,i,u.a));case 8:if("object"!==n(t)||null===t||Sn(t))return Nn("an OBJECT",t);var o=J;for(var a in t)if(t.hasOwnProperty(a)){u=yn(r.b,t[a]);if(!Su(u))return yu(s(Nu,a,u.a));o=D(P(a,u.a),o)}return wu(Tt(o));case 9:for(var f=r.f,c=r.g,v=0;v<c.length;v++){u=yn(c[v],t);if(!Su(u))return u;f=f(u.a)}return wu(f);case 10:u=yn(r.b,t);return Su(u)?yn(r.h(u.a),t):u;case 11:for(var l=J,d=r.g;d.b;d=d.b){u=yn(d.a,t);if(Su(u))return u;l=D(u.a,l)}return yu(Mu(Tt(l)));case 1:return yu(s(ku,r.a,An(t)));case 0:return wu(r.a)}}function wn(n,r,t){for(var e=r.length,u=new Array(e),i=0;i<e;i++){var o=yn(n,r[i]);if(!Su(o))return yu(s(Lu,i,o.a));u[i]=o.a}return wu(t(u))}function Sn(n){return Array.isArray(n)||"function"==typeof FileList&&n instanceof FileList}function kn(n){return s($u,n.length,function(r){return n[r]})}function Nn(n,r){return yu(s(ku,"Expecting "+n,An(r)))}function Ln(n,r){if(n===r)return!0;if(n.$!==r.$)return!1;switch(n.$){case 0:case 1:return n.a===r.a;case 2:return n.b===r.b;case 5:return n.c===r.c;case 3:case 4:case 8:return Ln(n.b,r.b);case 6:return n.d===r.d&&Ln(n.b,r.b);case 7:return n.e===r.e&&Ln(n.b,r.b);case 9:return n.f===r.f&&Mn(n.g,r.g);case 10:return n.h===r.h&&Ln(n.b,r.b);case 11:return Mn(n.g,r.g)}}function Mn(n,r){var t=n.length;if(t!==r.length)return!1;for(var e=0;e<t;e++)if(!Ln(n[e],r[e]))return!1;return!0}var Tn=e(function(n,r){return JSON.stringify(In(r),null,n)+""});function An(n){return{$:0,a:n}}function In(n){return n.a}var On=u(function(n,r,t){return t[n]=In(r),t});An(null);function _n(n){return{$:0,a:n}}function Cn(n){return{$:2,b:n,c:null}}var En=e(function(n,r){return{$:3,b:n,d:r}});e(function(n,r){return{$:4,b:n,d:r}});var Rn=0;function jn(n){var r={$:0,e:Rn++,f:n,g:null,h:[]};return Fn(r),r}function qn(n){return Cn(function(r){r(_n(jn(n)))})}function Pn(n,r){n.h.push(r),Fn(n)}var xn=e(function(n,r){return Cn(function(t){Pn(n,r),t(_n(q))})});var Bn=!1,zn=[];function Fn(n){if(zn.push(n),!Bn){for(Bn=!0;n=zn.shift();)Jn(n);Bn=!1}}function Jn(n){for(;n.f;){var r=n.f.$;if(0===r||1===r){for(;n.g&&n.g.$!==r;)n.g=n.g.i;if(!n.g)return;n.f=n.g.b(n.f.a),n.g=n.g.i}else{if(2===r)return void(n.f.c=n.f.b(function(r){n.f=r,Fn(n)}));if(5===r){if(0===n.h.length)return;n.f=n.f.b(n.h.shift())}else n.g={$:3===r?0:1,b:n.f.b,i:n.g},n.f=n.f.d}}}i(function(n,r,t,e){return Dn(r,e,n.init,n.update,n.subscriptions,function(){return function(){}})});function Dn(n,r,t,e,u,i){var o,a=s($n,n,An(r?r.flags:void 0));Su(a)||O(2,(o=a.a,zu(o)));var f={},c=(a=t(a.a)).a,v=i(d,c),l=function(n,r){var t;for(var e in Kn){var u=Kn[e];u.a&&((t=t||{})[e]=u.a(e,r)),n[e]=Gn(u,r)}return t}(f,d);function d(n,r){a=s(e,n,c),v(c=a.a,r),Yn(f,a.b,u(c))}return Yn(f,a.b,u(c)),l?{ports:l}:{}}var Kn={};function Gn(n,r){var t={g:r,h:void 0},e=n.c,u=n.d,i=n.e,o=n.f;return t.h=jn(s(En,function n(r){return s(En,n,{$:5,b:function(n){var a=n.a;return 0===n.$?l(u,t,a,r):i&&o?d(e,t,a.i,a.j,r):l(e,t,i?a.i:a.j,r)}})},n.b))}var Qn=e(function(n,r){return Cn(function(t){n.g(r),t(_n(q))})});e(function(n,r){return s(xn,n.h,{$:0,a:r})});function Un(n){return function(r){return{$:1,k:n,l:r}}}e(function(n,r){return{$:3,n:n,o:r}});function Yn(n,r,t){var e={};for(var u in Wn(!0,r,e,null),Wn(!1,t,e,null),n)Pn(n[u],{$:"fx",a:e[u]||{i:J,j:J}})}function Wn(n,r,t,e){switch(r.$){case 1:var u=r.k,i=function(n,r,t,e){return s(n?Kn[r].e:Kn[r].f,function(n){for(var r=t;r;r=r.q)n=r.p(n);return n},e)}(n,u,e,r.l);return void(t[u]=function(n,r,t){return t=t||{i:J,j:J},n?t.i=D(r,t.i):t.j=D(r,t.j),t}(n,i,t[u]));case 2:for(var o=r.m;o.b;o=o.b)Wn(n,o.a,t,e);return;case 3:return void Wn(n,r.o,t,{p:r.n,q:e})}}function Vn(n){Kn[n]&&O(3,n)}var Hn=e(function(n,r){return r});function Xn(n){var r,t=[],e=Kn[n].r,i=(r=0,Cn(function(n){var t=setTimeout(function(){n(_n(q))},r);return function(){clearTimeout(t)}}));return Kn[n].b=i,Kn[n].c=u(function(n,r,u){for(;r.b;r=r.b)for(var o=t,a=In(e(r.a)),f=0;f<o.length;f++)o[f](a);return i}),{subscribe:function(n){t.push(n)},unsubscribe:function(n){var r=(t=t.slice()).indexOf(n);r>=0&&t.splice(r,1)}}}var Zn,nr=e(function(n,r){return function(t){return n(r(t))}});function rr(n,r){var t=J,e=Kn[n].r,i=_n(null);return Kn[n].b=i,Kn[n].c=u(function(n,r,e){return t=r,i}),{send:function(u){var i=s($n,e,An(u));Su(i)||O(4,n,i.a);for(var o=i.a,a=t;a.b;a=a.b)r(a.a(o))}}}var tr="undefined"!=typeof document?document:{};function er(n,r){n.appendChild(r)}i(function(n,r,t,e){var u=e&&e.node?e.node:O(0);return u.parentNode.replaceChild(gr(n,function(){}),u),{}});function ur(n){return{$:0,a:n}}var ir=e(function(n,r){return e(function(t,e){for(var u=[],i=0;e.b;e=e.b){var o=e.a;i+=o.b||0,u.push(o)}return i+=u.length,{$:1,c:r,d:br(t),e:u,f:n,b:i}})})(void 0);e(function(n,r){return e(function(t,e){for(var u=[],i=0;e.b;e=e.b){var o=e.a;i+=o.b.b||0,u.push(o)}return i+=u.length,{$:2,c:r,d:br(t),e:u,f:n,b:i}})})(void 0);e(function(n,r){return{$:4,j:n,k:r,b:1+(r.b||0)}});function or(n,r){return{$:5,l:n,m:r,k:void 0}}e(function(n,r){return or([n,r],function(){return n(r)})}),u(function(n,r,t){return or([n,r,t],function(){return s(n,r,t)})}),i(function(n,r,t,e){return or([n,r,t,e],function(){return l(n,r,t,e)})}),o(function(n,r,t,e,u){return or([n,r,t,e,u],function(){return d(n,r,t,e,u)})}),a(function(n,r,t,e,u,i){return or([n,r,t,e,u,i],function(){return b(n,r,t,e,u,i)})}),f(function(n,r,t,e,u,i,o){return or([n,r,t,e,u,i,o],function(){return h(n,r,t,e,u,i,o)})}),c(function(n,r,t,e,u,i,o,a){return or([n,r,t,e,u,i,o,a],function(){return function(n,r,t,e,u,i,o,a){return 7===n.a?n.f(r,t,e,u,i,o,a):n(r)(t)(e)(u)(i)(o)(a)}(n,r,t,e,u,i,o,a)})}),v(function(n,r,t,e,u,i,o,a,f){return or([n,r,t,e,u,i,o,a,f],function(){return function(n,r,t,e,u,i,o,a,f){return 8===n.a?n.f(r,t,e,u,i,o,a,f):n(r)(t)(e)(u)(i)(o)(a)(f)}(n,r,t,e,u,i,o,a,f)})});var ar=e(function(n,r){return{$:"a0",n:n,o:r}}),fr=e(function(n,r){return{$:"a1",n:n,o:r}}),cr=e(function(n,r){return{$:"a2",n:n,o:r}}),vr=e(function(n,r){return{$:"a3",n:n,o:r}});u(function(n,r,t){return{$:"a4",n:r,o:{f:n,o:t}}});e(function(n,r){return"a0"===r.$?s(ar,r.n,function(n,r){var t=ec(r);return{$:r.$,a:t?l(tc,t<3?lr:dr,ei(n),r.a):s(ri,n,r.a)}}(n,r.o)):r});var sr,lr=e(function(n,r){return P(n(r.a),r.b)}),dr=e(function(n,r){return{message:n(r.message),stopPropagation:r.stopPropagation,preventDefault:r.preventDefault}});function br(n){for(var r={};n.b;n=n.b){var t=n.a,e=t.$,u=t.n,i=t.o;if("a2"!==e){var o=r[e]||(r[e]={});"a3"===e&&"class"===u?hr(o,u,i):o[u]=i}else"className"===u?hr(r,u,In(i)):r[u]=In(i)}return r}function hr(n,r,t){var e=n[r];n[r]=e?e+" "+t:t}function gr(r,t){var e=r.$;if(5===e)return gr(r.k||(r.k=r.m()),t);if(0===e)return tr.createTextNode(r.a);if(4===e){for(var u=r.k,i=r.j;4===u.$;)"object"!==n(i)?i=[i,u.j]:i.push(u.j),u=u.k;var o={j:i,p:t};return(a=gr(u,o)).elm_event_node_ref=o,a}if(3===e)return pr(a=r.h(r.g),t,r.d),a;var a=r.f?tr.createElementNS(r.f,r.c):tr.createElement(r.c);Zn&&"a"==r.c&&a.addEventListener("click",Zn(a)),pr(a,t,r.d);for(var f=r.e,c=0;c<f.length;c++)er(a,gr(1===e?f[c]:f[c].b,t));return a}function pr(n,r,t){for(var e in t){var u=t[e];"a1"===e?mr(n,u):"a0"===e?wr(n,r,u):"a3"===e?$r(n,u):"a4"===e?yr(n,u):("value"!==e&&"checked"!==e||n[e]!==u)&&(n[e]=u)}}function mr(n,r){var t=n.style;for(var e in r)t[e]=r[e]}function $r(n,r){for(var t in r){var e=r[t];void 0!==e?n.setAttribute(t,e):n.removeAttribute(t)}}function yr(n,r){for(var t in r){var e=r[t],u=e.f,i=e.o;void 0!==i?n.setAttributeNS(u,t,i):n.removeAttributeNS(u,t)}}function wr(n,r,t){var e=n.elmFs||(n.elmFs={});for(var u in t){var i=t[u],o=e[u];if(i){if(o){if(o.q.$===i.$){o.q=i;continue}n.removeEventListener(u,o)}o=Sr(r,i),n.addEventListener(u,o,sr&&{passive:ec(i)<2}),e[u]=o}else n.removeEventListener(u,o),e[u]=void 0}}try{window.addEventListener("t",null,Object.defineProperty({},"passive",{get:function(){sr=!0}}))}catch(tv){}function Sr(n,r){function t(r){var e=t.q,u=yn(e.a,r);if(Su(u)){for(var i,o=ec(e),a=u.a,f=o?o<3?a.a:a.message:a,c=1==o?a.b:3==o&&a.stopPropagation,v=(c&&r.stopPropagation(),(2==o?a.b:3==o&&a.preventDefault)&&r.preventDefault(),n);i=v.j;){if("function"==typeof i)f=i(f);else for(var s=i.length;s--;)f=i[s](f);v=v.p}v(f,c)}}return t.q=r,t}function kr(n,r){return n.$==r.$&&Ln(n.a,r.a)}function Nr(n,r){var t=[];return Mr(n,r,t,0),t}function Lr(n,r,t,e){var u={$:r,r:t,s:e,t:void 0,u:void 0};return n.push(u),u}function Mr(r,t,e,u){if(r!==t){var i=r.$,o=t.$;if(i!==o){if(1!==i||2!==o)return void Lr(e,0,u,t);t=function(n){for(var r=n.e,t=r.length,e=new Array(t),u=0;u<t;u++)e[u]=r[u].b;return{$:1,c:n.c,d:n.d,e:e,f:n.f,b:n.b}}(t),o=1}switch(o){case 5:for(var a=r.l,f=t.l,c=a.length,v=c===f.length;v&&c--;)v=a[c]===f[c];if(v)return void(t.k=r.k);t.k=t.m();var s=[];return Mr(r.k,t.k,s,0),void(s.length>0&&Lr(e,1,u,s));case 4:for(var l=r.j,d=t.j,b=!1,h=r.k;4===h.$;)b=!0,"object"!==n(l)?l=[l,h.j]:l.push(h.j),h=h.k;for(var g=t.k;4===g.$;)b=!0,"object"!==n(d)?d=[d,g.j]:d.push(g.j),g=g.k;return b&&l.length!==d.length?void Lr(e,0,u,t):((b?function(n,r){for(var t=0;t<n.length;t++)if(n[t]!==r[t])return!1;return!0}(l,d):l===d)||Lr(e,2,u,d),void Mr(h,g,e,u+1));case 0:return void(r.a!==t.a&&Lr(e,3,u,t.a));case 1:return void Tr(r,t,e,u,Ir);case 2:return void Tr(r,t,e,u,Or);case 3:if(r.h!==t.h)return void Lr(e,0,u,t);var p=Ar(r.d,t.d);p&&Lr(e,4,u,p);var m=t.i(r.g,t.g);return void(m&&Lr(e,5,u,m))}}}function Tr(n,r,t,e,u){if(n.c===r.c&&n.f===r.f){var i=Ar(n.d,r.d);i&&Lr(t,4,e,i),u(n,r,t,e)}else Lr(t,0,e,r)}function Ar(n,r,t){var e;for(var u in n)if("a1"!==u&&"a0"!==u&&"a3"!==u&&"a4"!==u)if(u in r){var i=n[u],o=r[u];i===o&&"value"!==u&&"checked"!==u||"a0"===t&&kr(i,o)||((e=e||{})[u]=o)}else(e=e||{})[u]=t?"a1"===t?"":"a0"===t||"a3"===t?void 0:{f:n[u].f,o:void 0}:"string"==typeof n[u]?"":null;else{var a=Ar(n[u],r[u]||{},u);a&&((e=e||{})[u]=a)}for(var f in r)f in n||((e=e||{})[f]=r[f]);return e}function Ir(n,r,t,e){var u=n.e,i=r.e,o=u.length,a=i.length;o>a?Lr(t,6,e,{v:a,i:o-a}):o<a&&Lr(t,7,e,{v:o,e:i});for(var f=o<a?o:a,c=0;c<f;c++){var v=u[c];Mr(v,i[c],t,++e),e+=v.b||0}}function Or(n,r,t,e){for(var u=[],i={},o=[],a=n.e,f=r.e,c=a.length,v=f.length,s=0,l=0,d=e;s<c&&l<v;){var b=a[s],h=f[l],g=b.a,p=h.a,m=b.b,$=h.b,y=void 0,w=void 0;if(g!==p){var S=a[s+1],k=f[l+1];if(S){var N=S.a,L=S.b;w=p===N}if(k){var M=k.a,T=k.b;y=g===M}if(y&&w)Mr(m,T,u,++d),Cr(i,u,g,$,l,o),d+=m.b||0,Er(i,u,g,L,++d),d+=L.b||0,s+=2,l+=2;else if(y)d++,Cr(i,u,p,$,l,o),Mr(m,T,u,d),d+=m.b||0,s+=1,l+=2;else if(w)Er(i,u,g,m,++d),d+=m.b||0,Mr(L,$,u,++d),d+=L.b||0,s+=2,l+=1;else{if(!S||N!==M)break;Er(i,u,g,m,++d),Cr(i,u,p,$,l,o),d+=m.b||0,Mr(L,T,u,++d),d+=L.b||0,s+=2,l+=2}}else Mr(m,$,u,++d),d+=m.b||0,s++,l++}for(;s<c;){d++;m=(b=a[s]).b;Er(i,u,b.a,m,d),d+=m.b||0,s++}for(;l<v;){var A=A||[];Cr(i,u,(h=f[l]).a,h.b,void 0,A),l++}(u.length>0||o.length>0||A)&&Lr(t,8,e,{w:u,x:o,y:A})}var _r="_elmW6BL";function Cr(n,r,t,e,u,i){var o=n[t];if(!o)return o={c:0,z:e,r:u,s:void 0},i.push({r:u,A:o}),void(n[t]=o);if(1===o.c){i.push({r:u,A:o}),o.c=2;var a=[];return Mr(o.z,e,a,o.r),o.r=u,void(o.s.s={w:a,A:o})}Cr(n,r,t+_r,e,u,i)}function Er(n,r,t,e,u){var i=n[t];if(i){if(0===i.c){i.c=2;var o=[];return Mr(e,i.z,o,u),void Lr(r,9,u,{w:o,A:i})}Er(n,r,t+_r,e,u)}else{var a=Lr(r,9,u,void 0);n[t]={c:1,z:e,r:u,s:a}}}function Rr(n,r,t,e){!function n(r,t,e,u,i,o,a){var f=e[u];var c=f.r;for(;c===i;){var v=f.$;if(1===v)Rr(r,t.k,f.s,a);else if(8===v){f.t=r,f.u=a;var s=f.s.w;s.length>0&&n(r,t,s,0,i,o,a)}else if(9===v){f.t=r,f.u=a;var l=f.s;if(l){l.A.s=r;var s=l.w;s.length>0&&n(r,t,s,0,i,o,a)}}else f.t=r,f.u=a;if(!(f=e[++u])||(c=f.r)>o)return u}var d=t.$;if(4===d){for(var b=t.k;4===b.$;)b=b.k;return n(r,b,e,u,i+1,o,r.elm_event_node_ref)}var h=t.e;var g=r.childNodes;for(var p=0;p<h.length;p++){i++;var m=1===d?h[p]:h[p].b,$=i+(m.b||0);if(i<=c&&c<=$&&(u=n(g[p],m,e,u,i,$,a),!(f=e[u])||(c=f.r)>o))return u;i=$}return u}(n,r,t,0,0,r.b,e)}function jr(n,r,t,e){return 0===t.length?n:(Rr(n,r,t,e),qr(n,t))}function qr(n,r){for(var t=0;t<r.length;t++){var e=r[t],u=e.t,i=Pr(u,e);u===n&&(n=i)}return n}function Pr(n,r){switch(r.$){case 0:return function(n,r,t){var e=n.parentNode,u=gr(r,t);u.elm_event_node_ref||(u.elm_event_node_ref=n.elm_event_node_ref);e&&u!==n&&e.replaceChild(u,n);return u}(n,r.s,r.u);case 4:return pr(n,r.u,r.s),n;case 3:return n.replaceData(0,n.length,r.s),n;case 1:return qr(n,r.s);case 2:return n.elm_event_node_ref?n.elm_event_node_ref.j=r.s:n.elm_event_node_ref={j:r.s,p:r.u},n;case 6:for(var t=r.s,e=0;e<t.i;e++)n.removeChild(n.childNodes[t.v]);return n;case 7:for(var u=(t=r.s).e,i=(e=t.v,n.childNodes[e]);e<u.length;e++)n.insertBefore(gr(u[e],r.u),i);return n;case 9:if(!(t=r.s))return n.parentNode.removeChild(n),n;var o=t.A;return void 0!==o.r&&n.parentNode.removeChild(n),o.s=qr(n,t.w),n;case 8:return function(n,r){var t=r.s,e=function(n,r){if(!n)return;for(var t=tr.createDocumentFragment(),e=0;e<n.length;e++){var u=n[e],i=u.A;er(t,2===i.c?i.s:gr(i.z,r.u))}return t}(t.y,r);n=qr(n,t.w);for(var u=t.x,i=0;i<u.length;i++){var o=u[i],a=o.A,f=2===a.c?a.s:gr(a.z,r.u);n.insertBefore(f,n.childNodes[o.r])}e&&er(n,e);return n}(n,r);case 5:return r.s(n);default:O(10)}}function xr(n){if(3===n.nodeType)return ur(n.textContent);if(1!==n.nodeType)return ur("");for(var r=J,t=n.attributes,e=t.length;e--;){var u=t[e],i=u.name,o=u.value;r=D(s(vr,i,o),r)}var a=n.tagName.toLowerCase(),f=J,c=n.childNodes;for(e=c.length;e--;)f=D(xr(c[e]),f);return l(ir,a,r,f)}var Br=i(function(n,r,t,e){return Dn(r,e,n.init,n.update,n.subscriptions,function(r,t){var u=n.view,i=e&&e.node?e.node:O(0),o=xr(i);return Fr(t,function(n){var t=u(n),e=Nr(o,t);i=jr(i,o,e,r),o=t})})}),zr=(i(function(n,r,t,e){return Dn(r,e,n.init,n.update,n.subscriptions,function(r,t){var e=n.setup&&n.setup(r),u=n.view,i=tr.title,o=tr.body,a=xr(o);return Fr(t,function(n){Zn=e;var t=u(n),f=ir("body")(J)(t.body),c=Nr(a,f);o=jr(o,a,c,r),a=f,Zn=0,i!==t.title&&(tr.title=i=t.title)})})}),"undefined"!=typeof cancelAnimationFrame&&cancelAnimationFrame,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(n){return setTimeout(n,1e3/60)});function Fr(n,r){r(n);var t=0;function e(){t=1===t?0:(zr(e),r(n),1)}return function(u,i){n=u,i?(r(n),2===t&&(t=1)):(0===t&&zr(e),t=2)}}e(function(n,r){return s(Qc,Cc,Cn(function(){r&&history.go(r),n()}))}),e(function(n,r){return s(Qc,Cc,Cn(function(){history.pushState({},"",r),n()}))}),e(function(n,r){return s(Qc,Cc,Cn(function(){history.replaceState({},"",r),n()}))});var Jr={addEventListener:function(){},removeEventListener:function(){}},Dr=("undefined"!=typeof document&&document,"undefined"!=typeof window?window:Jr);u(function(n,r,t){return qn(Cn(function(e){function u(n){jn(t(n))}return n.addEventListener(r,u,sr&&{passive:!0}),function(){n.removeEventListener(r,u)}}))}),e(function(n,r){var t=yn(n,r);return Su(t)?Ae(t.a):ut});function Kr(n,r){return Cn(function(t){zr(function(){var e=document.getElementById(n);t(e?_n(r(e)):{$:1,a:_c(n)})})})}e(function(n,r){return Kr(r,function(r){return r[n](),q})});e(function(n,r){return t=function(){return Dr.scroll(n,r),q},Cn(function(n){zr(function(){n(_n(t()))})});var t});u(function(n,r,t){return Kr(n,function(n){return n.scrollLeft=r,n.scrollTop=t,q})});var Gr,Qr,Ur,Yr,Wr,Vr,Hr,Xr,Zr,nt,rt,tt,et=function(n){return{$:"JsPort",a:n}},ut={$:"Nothing"},it={$:"EQ"},ot={$:"LT"},at=w,ft=u(function(n,r,t){var u=t.c,i=t.d,o=e(function(r,t){if("SubTree"===r.$){var e=r.a;return l(at,o,t,e)}var u=r.a;return l(at,n,t,u)});return l(at,o,l(at,n,r,i),u)}),ct=K,vt=function(n){return l(ft,ct,J,n)},st={$:"GT"},lt=u(function(n,r,t){for(;;){if("RBEmpty_elm_builtin"===t.$)return r;var e=t.b,u=t.c,i=t.d,o=t.e,a=n,f=l(n,e,u,l(lt,n,r,o));n=a,r=f,t=i}}),dt=function(n){return l(lt,u(function(n,r,t){return s(ct,P(n,r),t)}),J,n)},bt=function(n){return function(n){return l(lt,u(function(n,r,t){return s(ct,n,t)}),J,n)}(n.a)},ht=function(n){return n},gt=function(n){return{$:"Game",a:n}},pt=i(function(n,r,t,e){return{$:"Array_elm_builtin",a:n,b:r,c:t,d:e}}),mt=W,$t=e(function(n,r){return H(r)/H(n)}),yt=mt(s($t,2,32)),wt=[],St=d(pt,0,yt,wt,wt),kt=function(n){return{$:"Leaf",a:n}},Nt=function(n){return{$:"SubTree",a:n}},Lt=p,Mt=u(function(n,r,t){for(;;){if(!t.b)return r;var e=t.a,u=t.b,i=n,o=s(n,e,r);n=i,r=o,t=u}}),Tt=function(n){return l(Mt,ct,J,n)},At=e(function(n,r){for(;;){var t=s(Lt,32,n),e=t.a,u=t.b,i=s(ct,Nt(e),r);if(!u.b)return Tt(i);n=u,r=i}}),It=(e(function(n,r){return r(n)}),R),Ot=e(function(n,r){for(;;){var t=mt(r/32);if(1===t)return s(Lt,32,n).a;n=s(At,n,J),r=t}}),_t=(e(function(n,r){return n(r)}),V),Ct=e(function(n,r){return j(n,r)>0?n:r}),Et=function(n){return n.length},Rt=e(function(n,r){if(r.nodeListSize){var t=32*r.nodeListSize,e=_t(s($t,32,t-1)),u=n?Tt(r.nodeList):r.nodeList,i=s(Ot,u,r.nodeListSize);return d(pt,Et(r.tail)+t,s(Ct,5,e*yt),i,r.tail)}return d(pt,Et(r.tail),yt,wt,r.tail)}),jt=u(function(n,r,t){for(;;){var e=s(Lt,32,n),u=e.a,i=e.b;if(j(Et(u),32)<0)return s(Rt,!0,{nodeList:r,nodeListSize:t,tail:u});n=i,r=s(ct,kt(u),r),t=t+1}}),qt=function(n){return n.b?l(jt,n,J,0):St},Pt=e(function(n,r){return"Just"===r.$?r.a:n}),xt=4294967295>>>32-yt,Bt=m,zt=$,Ft=i(function(n,r,t,e){var u=xt&r>>>n,i=s(Bt,u,e);if("SubTree"===i.$){var o=i.a,a=d(Ft,n-yt,r,t,o);return l(zt,u,Nt(a),e)}var f=i.a,c=l(zt,xt&r,t,f);return l(zt,u,kt(c),e)}),Jt=function(n){return n>>>5<<5},Dt=u(function(n,r,t){var e=t.a,u=t.b,i=t.c,o=t.d;return n<0||j(n,e)>-1?t:j(n,Jt(e))>-1?d(pt,e,u,i,l(zt,xt&n,r,o)):d(pt,e,u,d(Ft,u,n,r,i),o)}),Kt=u(function(n,r,t){for(;;){if(r<=0)return n;n=s(ct,t,n),r=r-1,t=t}}),Gt=e(function(n,r){return l(Kt,J,n,r)}),Qt=X,Ut=function(n){return{$:"Piece",a:n}},Yt=function(n){return n.a},Wt=function(n){return n.a},Vt=e(function(n,r){return Ut(Yt(n)<<3|Wt(r))}),Ht=function(n){return{$:"PieceColor",a:n}},Xt=Ht(2),Zt=function(n){return{$:"PieceType",a:n}},ne=Zt(0),re=s(Vt,Xt,ne),te=Ht(3),ee=s(Vt,te,ne),ue=i(function(n,r,t,e){if(e.b){var u=e.a,i=e.b;if(i.b){var o=i.a,a=i.b;if(a.b){var f=a.a,c=a.b;if(c.b){var v=c.a,b=c.b;return s(n,u,s(n,o,s(n,f,s(n,v,t>500?l(Mt,n,r,Tt(b)):d(ue,n,r,t+1,b)))))}return s(n,u,s(n,o,s(n,f,r)))}return s(n,u,s(n,o,r))}return s(n,u,r)}return r}),ie=u(function(n,r,t){return d(ue,n,r,0,t)}),oe=e(function(n,r){return r.b?l(ie,ct,r,n):n}),ae=e(function(n,r){return l(ie,e(function(r,t){return s(ct,n(r),t)}),J,r)}),fe=e(function(n,r){return t=s(ae,n,r),l(ie,oe,J,t);var t}),ce=function(n){return{$:"Square",a:n}},ve=function(n){return n.a},se=function(n){return n.a},le=e(function(n,r){return ce(ve(n)+15*se(r))}),de=u(function(n,r,t){for(;;){if(!(j(n,r)<1))return t;var e=n,u=r-1,i=s(ct,r,t);n=e,r=u,t=i}}),be=e(function(n,r){return l(de,n,r,J)}),he=function(n){return{$:"SquareFile",a:n}},ge=s(ae,he,s(be,1,8)),pe=function(n){return{$:"SquareRank",a:n}},me=s(ae,pe,s(be,2,9)),$e=s(fe,function(n){return s(ae,le(n),me)},ge),ye=function(n){return n.a},we=l(Mt,e(function(n,r){return l(Dt,ye(n),re,r)}),qt(s(Gt,175,ee)),$e),Se=function(n){return{$:"CastleRights",a:n}},ke=Se(0),Ne=Ht(0),Le=function(n){return{$:"Position",a:n}},Me=Le({blackKingSquare:ut,board:we,castleRights:ke,epSquare:ut,gamePly:0,lastMove:ut,parent:ut,rule50Counter:0,sideToMove:Ne,whiteKingSquare:ut}),Te=u(function(n,r,t){for(;;){var e=s(Bt,xt&r>>>n,t);if("SubTree"!==e.$){var u=e.a;return s(Bt,xt&r,u)}var i=e.a;n=n-yt,r=r,t=i}}),Ae=function(n){return{$:"Just",a:n}},Ie=e(function(n,r){var t=r.a,e=r.b,u=r.c,i=r.d;return n<0||j(n,t)>-1?ut:j(n,Jt(t))>-1?Ae(s(Bt,xt&n,i)):Ae(l(Te,e,n,u))}),Oe=e(function(n,r){return l(ie,e(function(r,t){return n(r)?s(ct,r,t):t}),J,r)}),_e=function(n){if(n.b){var r=n.a;n.b;return Ae(r)}return ut},Ce=e(function(n,r){return G(s(en,n,r))}),Ee=tn,Re=function(n){return l(Ee,ct,J,n)},je=u(function(n,r,t){return{board:n,fileIndex:r,rankIndex:t}}),qe=function(n){var r=n.charCodeAt(0);return 55296<=r&&r<=56319?1024*(r-55296)+n.charCodeAt(1)-56320+65536:r},Pe=function(n){var r=qe(n);return r<=57&&48<=r},xe=e(function(n,r){return s(Dt,ye(r),n)}),Be=Y,ze=function(n){var r=n/8|0,t=s(Be,8,n);return ce(t+1+15*(r+2))},Fe=e(function(n,r){return l(xe,n,ze(r.fileIndex+8*r.rankIndex),r.board)}),Je=function(n){var r=qe(n);return r<=90&&65<=r},De=e(function(n,r){if("Just"===r.$){var t=r.a;return Ae(n(t))}return ut}),Ke=Ht(1),Ge=function(n){return B(n.toUpperCase())},Qe=Zt(3),Ue=Zt(6),Ye=Zt(2),We=Zt(1),Ve=Zt(5),He=Zt(4),Xe=function(n){var r=Ge(n);return C(r,B("P"))?Ae(We):C(r,B("N"))?Ae(Ye):C(r,B("B"))?Ae(Qe):C(r,B("R"))?Ae(He):C(r,B("Q"))?Ae(Ve):C(r,B("K"))?Ae(Ue):ut},Ze=e(function(n,r){var t=function(n){return s(De,Vt(Je(n)?Ne:Ke),Xe(n))}(n);if("Just"===t.$){var e=t.a;return z(r,{board:s(Fe,e,r),fileIndex:r.fileIndex+1})}return Pe(n)?z(r,{fileIndex:r.fileIndex+qe(n)-qe(B("0"))}):C(n,B("/"))?z(r,{fileIndex:0,rankIndex:r.rankIndex-1}):r}),nu=e(function(n,r){return s(Pt,ee,s(Ie,ye(n),r))}),ru=function(n){return C(n,B("K"))?1:C(n,B("Q"))?2:C(n,B("k"))?4:C(n,B("q"))?8:0},tu=s(Vt,Ke,Ue),eu=s(Vt,Ne,Ue),uu=e(function(n,r){return"Just"===r.$?n(r.a):ut}),iu=function(n){return C(n,B("w"))?Ae(Ne):C(n,B("b"))?Ae(Ke):ut},ou=function(n){return n.length},au=on,fu=e(function(n,r){return n<1?r:l(au,n,ou(r),r)}),cu=function(n){var r=qe(n)-qe(B("a"));return r>=0&&j(r,8)<0?Ae(he(r+1)):ut},vu=function(n){var r=qe(n)-qe(B("1"));return r>=0&&j(r,8)<0?Ae(pe(r+2)):ut},su=function(n){var r=function(n){return s(uu,vu,_e(Re(n)))}(s(fu,1,n)),t=function(n){return s(uu,cu,_e(Re(n)))}(n);if("Just"===t.$){var e=t.a;return s(De,le(e),r)}return ut},lu=s(Pt,Me,(Gr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Ur=qt(s(Ce," ",Gr)),Yr=su(s(Pt,"-",s(Ie,3,Ur))),Qr=s(Pt,"w",s(Ie,1,Ur)),Wr=s(uu,iu,_e(Re(Qr))),Vr=function(n){return Se(l(Mt,Qt,0,s(ae,ru,Re(n))))}(s(Pt,"-",s(Ie,2,Ur))),Hr=function(n){return l(Mt,Ze,l(je,we,0,7),Re(n)).board}(s(Pt,"",s(Ie,0,Ur))),Xr=_e(s(Oe,function(n){return C(s(nu,n,Hr),eu)},$e)),Zr=_e(s(Oe,function(n){return C(s(nu,n,Hr),tu)},$e)),Ae(Le({blackKingSquare:Zr,board:Hr,castleRights:Vr,epSquare:Yr,gamePly:0,lastMove:ut,parent:ut,rule50Counter:0,sideToMove:s(Pt,Ne,Wr),whiteKingSquare:Xr})))),du={currentMoveIndex:0,currentPosition:lu,positions:qt(G([lu])),result:{$:"UnknownResult"},tags:J},bu=gt(du),hu={candidateMoves:J,error:ut,game:bu,gameState:{$:"Init"},isBlack:!1,myId:ut,otherId:"",selectedSquare:ut},gu=(nt="output",rt=ht,Vn(nt),Kn[nt]={e:Hn,r:rt,a:Xn},Un(nt)),pu=g,mu=o(function(n,r,t,e,u){for(;;){if(r<0)return s(Rt,!1,{nodeList:e,nodeListSize:t/32|0,tail:u});var i=kt(l(pu,32,r,n));n=n,r=r-32,t=t,e=s(ct,i,e),u=u}}),$u=e(function(n,r){if(n<=0)return St;var t=n%32,e=l(pu,t,n-t,r);return b(mu,r,n-t-32,n,J,e)}),yu=function(n){return{$:"Err",a:n}},wu=function(n){return{$:"Ok",a:n}},Su=function(n){return"Ok"===n.$},ku=e(function(n,r){return{$:"Failure",a:n,b:r}}),Nu=e(function(n,r){return{$:"Field",a:n,b:r}}),Lu=e(function(n,r){return{$:"Index",a:n,b:r}}),Mu=function(n){return{$:"OneOf",a:n}},Tu=function(n){var r=qe(n);return 97<=r&&r<=122},Au=function(n){return Tu(n)||Je(n)},Iu=function(n){return Tu(n)||Je(n)||Pe(n)},Ou=function(n){return l(Mt,e(function(n,r){return r+1}),0,n)},_u=U,Cu=e(function(n,r){return l(_u,n,s(be,0,Ou(r)-1),r)}),Eu=an,Ru=vn,ju=e(function(n,r){return s(un,n,Q(r))}),qu=function(n){var r=n.charCodeAt(0);return r?Ae(55296<=r&&r<=56319?P(B(n[0]+n[1]),n.slice(2)):P(B(n[0]),n.slice(1))):ut},Pu=function(n){return s(ju,"\n    ",s(Ce,"\n",n))},xu=Tn,Bu=e(function(n,r){return"\n\n("+Ru(n+1)+") "+Pu(zu(r))}),zu=function(n){return s(Fu,n,J)},Fu=e(function(n,r){n:for(;;)switch(n.$){case"Field":var t=n.a,e=n.b,u=function(){var n=qu(t);if("Nothing"===n.$)return!1;var r=n.a,e=r.a,u=r.b;return Au(e)&&s(Eu,Iu,u)}(),i=e,o=s(ct,u?"."+t:"['"+t+"']",r);n=i,r=o;continue n;case"Index":var a=n.a,f=(e=n.b,"["+Ru(a)+"]");i=e,o=s(ct,f,r);n=i,r=o;continue n;case"OneOf":var c=n.a;if(c.b){if(c.b.b){var v=(r.b?"The Json.Decode.oneOf at json"+s(ju,"",Tt(r)):"Json.Decode.oneOf")+" failed in the following "+Ru(Ou(c))+" ways:";return s(ju,"\n\n",s(ct,v,s(Cu,Bu,c)))}n=i=e=c.a,r=o=r;continue n}return"Ran into a Json.Decode.oneOf with no possibilities"+(r.b?" at json"+s(ju,"",Tt(r)):"!");default:var l=n.a,d=n.b;return(v=r.b?"Problem with the value at json"+s(ju,"",Tt(r))+":\n\n    ":"Problem with the given value:\n\n")+(Pu(s(xu,4,d))+"\n\n")+l}}),Ju=An,Du=ln,Ku=function(n,r){return Vn(n),Kn[n]={f:nr,r:r,a:rr},Un(n)}("input",Du),Gu={$:"MyTurn"},Qu={$:"OtherTurn"},Uu=function(n){return{$:"GotId",a:n}},Yu=function(n){return{$:"GotMove",a:n}},Wu={$:"GotRematch"},Vu={$:"Ready"},Hu={$:"Ready2"},Xu=gn,Zu=function(n){return{$:1,a:n}},ni=bn,ri=pn,ti=dn,ei=function(n){return{$:0,a:n}},ui=s(Xu,function(n){switch(n){case"Ready":return ei(Vu);case"Ready2":return ei(Hu);case"GotMove":return s(ri,Yu,s(ni,"move",ti));case"Rematch":return ei(Wu);default:return Zu("Unknown object")}},s(ni,"type",ti)),ii=s(Xu,function(n){switch(n){case"GotId":return s(ri,Uu,s(ni,"id",ti));case"GotMsg":return s(ni,"data",ui);default:return Zu("Unknown object")}},s(ni,"type",ti)),oi=function(n){return!n},ai=function(n){return z(n,{candidateMoves:J,game:bu,gameState:n.isBlack?Gu:Qu,isBlack:!n.isBlack,selectedSquare:ut})},fi=function(n){return An(l(Mt,e(function(n,r){var t=n.a,e=n.b;return l(On,t,e,r)}),{},n))},ci=An,vi=function(n){return gu(fi(G([P("type",ci("Send")),P("data",fi(n))])))},si=function(n){return{$:2,m:n}},li=si(J),di=y,bi=function(n){return[n]},hi=i(function(n,r,t,e){var u=xt&r>>>n;if(j(u,Et(e))>-1){if(5===n)return s(di,kt(t),e);var i=Nt(d(hi,n-yt,r,t,wt));return s(di,i,e)}var o=s(Bt,u,e);if("SubTree"===o.$){var a=o.a;i=Nt(d(hi,n-yt,r,t,a));return l(zt,u,i,e)}i=Nt(d(hi,n-yt,r,t,bi(o)));return l(zt,u,i,e)}),gi=e(function(n,r){var t=r.a,e=r.b,u=r.c,i=r.d,o=Et(i),a=Et(n),f=t+(a-o);if(C(a,32)){if(j(f>>>yt,1<<e)>0){var c=e+yt,v=d(hi,c,t,n,bi(Nt(u)));return d(pt,f,c,v,wt)}return d(pt,f,e,d(hi,e,t,n,u),wt)}return d(pt,f,e,u,n)}),pi=e(function(n,r){var t=r.d;return s(gi,s(di,n,t),r)}),mi=k,$i=S,yi=e(function(n,r){var t=Et(n),e=32-Et(r.tail)-t,u=l(mi,32,r.tail,n);return e<0?{nodeList:s(ct,kt(u),r.nodeList),nodeListSize:r.nodeListSize+1,tail:l($i,e,t,n)}:e?{nodeList:r.nodeList,nodeListSize:r.nodeListSize,tail:u}:{nodeList:s(ct,kt(u),r.nodeList),nodeListSize:r.nodeListSize+1,tail:wt}}),wi=e(function(n,r){for(;;){if(n<=0)return r;if(!r.b)return r;r.a;n=n-1,r=r.b}}),Si=e(function(n,r){var t=r.a,u=r.c,i=r.d;if(n){if(j(n,Jt(t))>-1)return d(pt,t-n,yt,wt,l($i,n-Jt(t),Et(i),i));var o=n/32|0,a=e(function(n,r){if("SubTree"===n.$){var t=n.a;return l(at,a,r,t)}var e=n.a;return s(ct,e,r)}),f=l(at,a,G([i]),u),c=s(wi,o,f);if(c.b){var v=c.a,b=c.b,h={nodeList:J,nodeListSize:0,tail:l($i,n-32*o,Et(v),v)};return s(Rt,!0,l(Mt,yi,h,b))}return St}return r}),ki=i(function(n,r,t,e){for(;;){var u=s(Bt,xt&t>>>n,e);if("SubTree"!==u.$){var i=u.a;return l($i,0,xt&r,i)}var o=u.a;n=n-yt,r=r,t=t,e=o}}),Ni=u(function(n,r,t){for(;;){if(j(n,r)<1||!Et(t))return t;var e=s(Bt,0,t);if("SubTree"!==e.$)return t;var u=e.a;n=n-yt,r=r,t=u}}),Li=u(function(n,r,t){var e=xt&r>>>n,u=s(Bt,e,t);if("SubTree"===u.$){var i=u.a,o=l(Li,n-yt,r,i);return Et(o)?l(zt,e,Nt(o),l($i,0,e+1,t)):l($i,0,e,t)}return l($i,0,e,t)}),Mi=e(function(n,r){var t=r.a,e=r.b,u=r.c,i=r.d;if(C(n,t))return r;if(j(n,Jt(t))>-1)return d(pt,n,e,u,l($i,0,xt&n,i));var o=Jt(n),a=_t(s($t,32,s(Ct,1,o-1))),f=s(Ct,5,a*yt);return d(pt,n,f,l(Ni,e,f,l(Li,e,o,u)),d(ki,e,n,o,u))}),Ti=e(function(n,r){var t=r.a,e=n<0?t+n:n;return e<0?0:j(e,t)>0?t:e}),Ai=u(function(n,r,t){var e=s(Ti,r,t),u=s(Ti,n,t);return j(u,e)>0?St:s(Si,u,s(Mi,e,t))}),Ii=function(n){return n.currentPosition},Oi=function(n){return s(Dt,ye(n),re)},_i=u(function(n,r,t){var e=s(nu,n,t);return l(xe,e,r,s(Oi,n,t))}),Ci=function(n){return n.a},Ei=function(n){return ze(Ci(n)>>6&63)},Ri=function(n){return 32768&Ci(n)},ji=function(n){return ze(63&Ci(n))},qi=function(n){return Ri(n)&&j(ye(Ei(n)),ye(ji(n)))<0},Pi=function(n){return Ri(n)&&j(ye(Ei(n)),ye(ji(n)))>0},xi=function(n){var r=Zt(Ci(n)>>12&7);return C(r,ne)?ut:Ae(r)},Bi=function(n){return n.a},zi=function(n){return Ht(Bi(n)>>3)},Fi=function(n){return n.a},Ji=e(function(n,r){return ce(ye(n)+Fi(r))}),Di=function(n){return he(s(Be,15,ye(n)))},Ki=function(n){return pe(ye(n)/15|0)},Gi=function(n){return{$:"SquareDelta",a:n}},Qi=Gi(1),Ui=e(function(n,r){return Gi(n*Fi(r))}),Yi=function(n){return s(Ui,-1,n)},Wi=Yi(Qi),Vi=e(function(n,r){var t=zi(s(nu,Ei(n),r)),e=ji(n),u=Ei(n),i=xi(n);if("Nothing"===i.$){if(qi(n))return l(_i,s(Ji,e,Qi),s(Ji,u,Qi),l(_i,u,e,r));if(Pi(n))return l(_i,s(Ji,e,s(Ui,2,Wi)),s(Ji,u,Wi),l(_i,u,e,r));if(function(n){return 65536&Ci(n)}(n)){var o=Di(e),a=Ki(u);return s(Oi,s(le,o,a),l(_i,u,e,r))}return l(_i,u,e,r)}var f=i.a;return l(xe,s(Vt,t,f),e,s(Oi,u,r))}),Hi=function(n){return n.a},Xi=e(function(n,r){return Se(Hi(r)&~(1<<2*Yt(n)))}),Zi=e(function(n,r){return Se(Hi(r)&~(1<<2*Yt(n)+1))}),no=e(function(n,r){return s(Zi,n,s(Xi,n,r))}),ro=he(1),to=pe(2),eo=s(le,ro,to),uo=pe(9),io=s(le,ro,uo),oo=he(5),ao=s(le,oo,to),fo=s(le,oo,uo),co=he(8),vo=s(le,co,to),so=s(le,co,uo),lo=e(function(n,r){var t=ji(n),e=Ei(n);return(C(e,fo)?no(Ke):ht)((C(e,ao)?no(Ne):ht)((C(e,so)||C(t,so)?Xi(Ke):ht)((C(e,vo)||C(t,vo)?Xi(Ne):ht)((C(e,io)||C(t,io)?Zi(Ke):ht)((C(e,eo)||C(t,eo)?Zi(Ne):ht)(r))))))}),bo=s(Vt,Ke,We),ho=function(n){return Zt(7&Bi(n))},go=s(Vt,Ne,We),po=u(function(n,r,t){return r(n(t))}),mo=Z,$o=s(po,Yt,s(po,mo(1),Ht)),yo=function(n){return n.a},wo=e(function(n,r){return s(nu,n,yo(r).board)}),So=e(function(n,r){return Gi(ye(n)-ye(r))}),ko=Gi(15),No=e(function(n,r){return Gi(Fi(n)+Fi(r))}),Lo=s(No,ko,ko),Mo=Yi(ko),To=s(No,Mo,Mo),Ao=e(function(n,r){var t=ji(n),e=Ei(n),u=s(wo,e,r),i=r.a;return Le({blackKingSquare:C(u,tu)?Ae(t):i.blackKingSquare,board:s(Vi,n,i.board),castleRights:s(lo,n,i.castleRights),epSquare:C(u,go)&&C(s(So,t,e),Lo)?Ae(s(Ji,e,ko)):C(u,bo)&&C(s(So,t,e),To)?Ae(s(Ji,e,Mo)):ut,gamePly:i.gamePly+1,lastMove:Ae(n),parent:Ae(r),rule50Counter:C(ho(u),We)||!C(s(wo,t,r),re)?0:i.rule50Counter+1,sideToMove:$o(i.sideToMove),whiteKingSquare:C(u,eu)?Ae(t):i.whiteKingSquare})}),Io=e(function(n,r){var t=s(Ao,n,Ii(r));return z(r,{currentMoveIndex:r.currentMoveIndex+1,currentPosition:t,positions:s(pi,t,l(Ai,0,1+r.currentMoveIndex,r.positions))})}),Oo=e(function(n,r){var t=r.a;return gt(s(Io,n,t))}),_o=function(n){var r=n.a;return Ii(r)},Co=function(n){return n.toUpperCase()},Eo=nn,Ro=function(n){return s(Eo,n,"")},jo=function(n){return C(n,We)?B("P"):C(n,Ye)?B("N"):C(n,Qe)?B("B"):C(n,He)?B("R"):C(n,Ve)?B("Q"):C(n,Ue)?B("K"):B("?")},qo=s(po,jo,Ro),Po=function(n){return B(n<0||1114111<n?"�":n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode(Math.floor(n/1024)+55296,n%1024+56320)))},xo=s(po,function(n){return Po(ve(n)-1+qe(B("a")))},Ro),Bo=s(po,function(n){return Po(se(n)-2+qe(B("1")))},Ro),zo=function(n){return F(xo(Di(n)),Bo(Ki(n)))},Fo=e(function(n,r){var t=ji(n),e=xi(n),u=Ei(n);return F(C(Di(u),Di(t))?"":xo(Di(u))+"x",F(zo(t),function(){if("Nothing"===e.$)return"";var n=e.a;return"="+Co(qo(n))}()))}),Jo=u(function(n,r,t){return n(r(t))}),Do=e(function(n,r){for(;;){if(!r.b)return!1;var t=r.a,e=r.b;if(n(t))return!0;n=n,r=e}}),Ko=e(function(n,r){return!s(Do,s(Jo,oi,n),r)}),Go=e(function(n,r){return C(n,r)||!C(Di(Ei(n)),Di(Ei(r)))}),Qo=e(function(n,r){return C(n,r)||!C(Ki(Ei(n)),Ki(Ei(r)))}),Uo=e(function(n,r){return C(n,Ne)?yo(r).whiteKingSquare:yo(r).blackKingSquare}),Yo=i(function(n,r,t,u){var i=e(function(r,e){return C(r,t)||C(s(nu,r,n),re)&&s(i,s(Ji,r,u),e)});return s(i,s(Ji,r,u),t)}),Wo=e(function(n,r){return s($u,n,function(n){return r})}),Vo=s(Vt,Ke,Qe),Ho=s(Vt,Ke,Ye),Xo=s(Vt,Ke,Ve),Zo=s(Vt,Ke,He),na=s(Vt,Ne,Qe),ra=s(Vt,Ne,Ye),ta=s(Vt,Ne,Ve),ea=s(Vt,Ne,He),ua=s(No,ko,Qi),ia=s(No,ko,s(Ui,2,Qi)),oa=s(No,s(Ui,2,ko),Qi),aa=s(No,s(Ui,2,ko),Wi),fa=s(No,ko,Wi),ca=s(No,ko,s(Ui,2,Wi)),va=s(No,Mo,Qi),sa=s(No,Mo,s(Ui,2,Qi)),la=s(No,s(Ui,2,Mo),Qi),da=s(No,s(Ui,2,Mo),Wi),ba=s(No,Mo,Wi),ha=s(No,Mo,s(Ui,2,Wi)),ga=function(n){return C(n,go)?G([fa,ua]):C(n,ra)?G([aa,oa,ca,ia,da,la,ha,sa]):C(n,na)?G([fa,ua,ba,va]):C(n,ea)?G([ko,Mo,Wi,Qi]):C(n,ta)?G([fa,ua,ba,va,ko,Mo,Wi,Qi]):C(n,eu)?G([fa,ua,ba,va,ko,Mo,Wi,Qi]):C(n,bo)?G([ba,va]):C(n,Ho)?G([aa,oa,ca,ia,da,la,ha,sa]):C(n,Vo)?G([fa,ua,ba,va]):C(n,Zo)?G([ko,Mo,Wi,Qi]):C(n,Xo)?G([fa,ua,ba,va,ko,Mo,Wi,Qi]):C(n,tu)?G([fa,ua,ba,va,ko,Mo,Wi,Qi]):J},pa=s(po,ho,function(n){return C(n,Qe)||C(n,He)||C(n,Ve)}),ma=function(n){return t=Di(n),j(ve(t),1)<0||j(ve(t),8)>0||(r=Ki(n),j(se(r),2)<0||j(se(r),9)>0);var r,t},$a=e(function(n,r){var t=e(function(n,t){for(;;){if(ma(n))return t;var e=s(Ji,n,r),u=s(ct,n,t);n=e,t=u}});return Tt(s(t,s(Ji,n,r),J))}),ya=e(function(n,r){return s(ae,function(r){return s(So,r,n)},s($a,n,r))}),wa=Gi(112),Sa=qt(s(fe,function(n){var r=s(fe,function(r){return pa(n)?s(ae,function(n){return P(r,n)},(t=r,l(Mt,e(function(n,r){var e=s(ya,n,t);return j(Ou(e),Ou(r))>0?e:r}),J,$e))):G([P(r,r)]);var t},ga(n)),t=Fi(wa);return vt(l(Mt,e(function(n,r){var e=n.a,u=n.b;return l(Dt,t+Fi(u),Ae(e),r)}),s(Wo,2*t+1,ut),r))},s(ae,Ut,s(be,0,Bi(tu))))),ka=u(function(n,r,t){var e=Fi(wa);return s(Pt,ut,s(Ie,Bi(n)*(2*e+1)+ye(t)-ye(r)+e,Sa))}),Na=u(function(n,r,t){var e=s(nu,n,t),u=l(ka,e,n,r);if("Nothing"===u.$)return!1;var i=u.a;return!pa(e)||d(Yo,t,n,r,i)}),La=u(function(n,r,t){return s(Do,function(e){return C(zi(s(nu,e,t)),n)&&l(Na,e,r,t)},$e)}),Ma=u(function(n,r,t){return l(La,n,r,yo(t).board)}),Ta=e(function(n,r){var t=s(Uo,n,r);if("Nothing"===t.$)return!1;var e=t.a;return l(Ma,$o(n),e,r)}),Aa=function(n){return yo(n).sideToMove},Ia=e(function(n,r){return!s(Ta,Aa(n),s(Ao,r,n))}),Oa=e(function(n,r){return C(s(nu,n,r),re)}),_a=e(function(n,r){return s(Oa,n,yo(r).board)}),Ca=function(n){return{$:"Move",a:n}},Ea=function(n){var r=ye(n)/15|0;return s(Be,15,ye(n))-1+8*(r-2)},Ra=e(function(n,r){return Ca(Ea(r)|Ea(n)<<6)}),ja=u(function(n,r,t){return Ca(Ea(r)|Ea(n)<<6|Wt(t)<<12)}),qa=e(function(n,r){return C(r,Ne)?C(se(Ki(n)),3):C(se(Ki(n)),8)}),Pa=u(function(n,r,t){var e=$o(n),u=s(Vt,n,We),i=C(n,Ne)?G([ba,va]):G([fa,ua]);return s(fe,function(n){return s(qa,n,e)?s(ae,s(ja,n,r),G([Ve,He,Qe,Ye])):G([s(Ra,n,r)])},s(Oe,function(n){return C(s(wo,n,t),u)},s(ae,Ji(r),i)))}),xa=e(function(n,r){return Ca(Ea(r)|Ea(n)<<6|65536)}),Ba=function(n){return yo(n).epSquare},za=u(function(n,r,t){var e=Ba(t);if("Nothing"===e.$)return J;if(C(e.a,r)){var u=s(Vt,n,We),i=C(n,Ne)?G([ba,va]):G([fa,ua]);return s(ae,function(n){return s(xa,n,r)},s(Oe,function(n){return C(s(wo,n,t),u)},s(ae,Ji(r),i)))}return J}),Fa=u(function(n,r,t){var e=$o(n),u=C(n,Ne)?Mo:ko,i=s(Vt,n,We),o=s(Ji,r,u);if(C(s(wo,o,t),i))return s(qa,o,e)?s(ae,s(ja,o,r),G([Ve,He,Qe,Ye])):G([s(Ra,o,r)]);if(s(_a,o,t)){var a=s(Ji,o,u);return s(qa,a,n)&&C(s(wo,a,t),i)?G([s(Ra,a,r)]):J}return J}),Ja=u(function(n,r,t){return F(l(za,n,r,t),s(_a,r,t)?l(Fa,n,r,t):l(Pa,n,r,t))}),Da=u(function(n,r,t){return function(r){for(;;){if(!C(s(nu,r,n),re))return r;r=s(Ji,r,t)}}(s(Ji,r,t))}),Ka=u(function(n,r,t){return l(Da,yo(n).board,r,t)}),Ga=i(function(n,r,t,e){var u=s(Vt,n,r);return s(ae,function(n){return s(Ra,n,t)},s(Oe,function(n){return C(s(wo,n,e),u)},s(ae,pa(u)?s(Ka,e,t):Ji(t),ga(u))))}),Qa=u(function(n,r,t){var e=Aa(t),u=$o(e),i=s(wo,r,t);return C(i,re)||C(zi(i),u)?C(n,We)?l(Ja,e,r,t):d(Ga,e,n,r,t):J}),Ua=u(function(n,r,t){return s(Oe,Ia(t),l(Qa,n,r,t))}),Ya=u(function(n,r,t){var e=l(Ua,ho(n),ji(r),t);return Ou(e)<=1?"":s(Ko,Go(r),e)?xo(Di(Ei(r))):s(Ko,Qo(r),e)?Bo(Ki(Ei(r))):zo(Ei(r))}),Wa=function(n){return B(n.toLowerCase())},Va=s(po,function(n){return C(zi(n),Ne)?Ge(jo(ho(n))):Wa(jo(ho(n)))},Ro),Ha=e(function(n,r){var t=s(wo,Ei(n),r);return F(Co(Va(t)),F(l(Ya,t,n,r),F(s(_a,ji(n),r)?"":"x",zo(ji(n)))))}),Xa=function(n){return s(Ta,Aa(n),n)},Za=e(function(n,r){return Xa(s(Ao,n,r))}),nf=u(function(n,r,t){var u=Aa(r),i=$o(u),o=e(function(e,u){for(;;){if(!s(_a,e,r))return C(zi(s(wo,e,r)),i)?s(ct,s(Ra,n,e),u):u;var o=s(Ji,e,t),a=s(ct,s(Ra,n,e),u);e=o,u=a}});return s(o,s(Ji,n,t),J)}),rf=e(function(n,r){return s(fe,s(nf,n,r),ga(na))}),tf=e(function(n,r){return Ca(Ea(r)|Ea(n)<<6|32768)}),ef=e(function(n,r){return Hi(r)&1<<2*Yt(n)}),uf=e(function(n,r){return s(ef,n,yo(r).castleRights)}),of=e(function(n,r){return Hi(r)&1<<2*Yt(n)+1}),af=e(function(n,r){return s(of,n,yo(r).castleRights)}),ff=i(function(n,r,t,e){return F(function(){if(s(uf,n,e)){var u=s(Ji,t,Qi),i=s(Ji,u,Qi);return!s(_a,u,e)||!s(_a,i,e)||l(Ma,r,t,e)||l(Ma,r,u,e)||l(Ma,r,i,e)?J:G([s(tf,t,i)])}return J}(),function(){if(s(af,n,e)){var u=s(Ji,t,Wi),i=s(Ji,u,Wi),o=s(Ji,i,Wi);return s(_a,u,e)&&s(_a,i,e)&&s(_a,o,e)&&!l(Ma,r,t,e)&&!l(Ma,r,u,e)&&!l(Ma,r,i,e)?G([s(tf,t,i)]):J}return J}())}),cf=e(function(n,r){var t=Aa(r),e=$o(t);return F(s(ae,function(r){return s(Ra,n,r)},s(Oe,function(n){return s(_a,n,r)||C(zi(s(wo,n,r)),e)},s(ae,Ji(n),ga(eu)))),d(ff,t,e,n,r))}),vf=e(function(n,r){var t=$o(Aa(r));return s(ae,function(r){return s(Ra,n,r)},s(Oe,function(n){return s(_a,n,r)||C(zi(s(wo,n,r)),t)},s(ae,Ji(n),ga(ra))))}),sf=e(function(n,r){return zi(s(wo,n,r))}),lf=i(function(n,r,t,e){var u=C(n,Ne)?G([fa,ua]):G([ba,va]),i=s(Oe,function(n){return C(s(sf,n,e),r)},s(ae,Ji(t),u));return s(qa,t,r)?s(fe,function(n){return s(ae,s(ja,t,n),G([Ve,He,Qe,Ye]))},i):s(ae,Ra(t),i)}),df=i(function(n,r,t,e){var u=Ba(e);if("Nothing"===u.$)return J;var i=u.a,o=C(n,Ne)?G([fa,ua]):G([ba,va]);return s(ae,xa(t),s(Oe,It(i),s(ae,Ji(t),o)))}),bf=i(function(n,r,t,e){var u=C(n,Ne)?ko:Mo,i=s(Ui,2,u);return s(_a,s(Ji,t,u),e)?s(qa,t,r)?s(ae,s(ja,t,s(Ji,t,u)),G([Ve,He,Qe,Ye])):s(qa,t,n)?F(G([s(Ra,t,s(Ji,t,u))]),s(_a,s(Ji,t,i),e)?G([s(Ra,t,s(Ji,t,i))]):J):G([s(Ra,t,s(Ji,t,u))]):J}),hf=e(function(n,r){var t=Aa(r),e=$o(t);return F(d(bf,t,e,n,r),F(d(lf,t,e,n,r),d(df,t,e,n,r)))}),gf=e(function(n,r){return s(fe,s(nf,n,r),ga(ta))}),pf=e(function(n,r){return s(fe,s(nf,n,r),ga(ea))}),mf=e(function(n,r){var t=s(wo,n,r);return C(zi(t),Aa(r))?C(ho(t),We)?s(hf,n,r):C(ho(t),Ye)?s(vf,n,r):C(ho(t),Qe)?s(rf,n,r):C(ho(t),He)?s(pf,n,r):C(ho(t),Ve)?s(gf,n,r):C(ho(t),Ue)?s(cf,n,r):J:J}),$f=e(function(n,r){return s(Oe,Ia(r),s(mf,n,r))}),yf=function(n){return s(fe,function(r){return s($f,r,n)},$e)},wf=function(n){return Xa(n)&&!Ou(yf(n))},Sf=e(function(n,r){return wf(s(Ao,n,r))}),kf=e(function(n,r){return F(function(){if(qi(n))return"O-O";if(Pi(n))return"O-O-O";var t=s(wo,Ei(n),r);return C(ho(t),We)?s(Fo,n,r):s(Ha,n,r)}(),s(Sf,n,r)?"#":s(Za,n,r)?"+":"")}),Nf=e(function(n,r){var t="MyTurn"===r.gameState.$?x(s(Oo,n,r.game),Qu,vi(G([P("type",ci("GotMove")),P("move",ci(s(kf,n,_o(r.game))))]))):x(r.game,r.gameState,li),e=t.a,u=t.b,i=t.c;return P(z(r,{candidateMoves:J,game:e,gameState:u,selectedSquare:ut}),i)}),Lf=ji,Mf=$f,Tf=e(function(n,r){var t=s(Oe,function(r){return C(Lf(r),n)},r.candidateMoves),e=_e(t);if("Just"===e.$){var u=e.a;return s(Nf,u,r)}var i=s(Mf,n,_o(r.game));return P(z(r,{candidateMoves:i,selectedSquare:Ou(i)?Ae(n):ut}),li)}),Af=$n,If=rn,Of=e(function(n,r){return n<1?"":l(au,0,n,r)}),_f=function(n){return!(C(n,B("x"))||C(n,B("="))||C(n,B("+"))||C(n,B("#")))},Cf=u(function(n,r,t){var e=n(r);if("Just"===e.$){var u=e.a;return s(ct,u,t)}return t}),Ef=e(function(n,r){return l(ie,Cf(n),J,r)}),Rf=e(function(n,r){return n<1?r:l(au,0,-n,r)}),jf=e(function(n,r){return n<1?"":l(au,-n,ou(r),r)}),qf=u(function(n,r,t){if("Nothing"===n.$){if("Nothing"===r.$)return!0;var e=r.a;return C(Di(Ei(t)),e)}var u=n.a;if("Nothing"===r.$)return C(xi(t),Ae(u));e=r.a;return C(xi(t),Ae(u))&&C(Di(Ei(t)),e)}),Pf=i(function(n,r,t,e){var u=s(Oe,s(qf,r,t),l(Ua,We,n,e));return 1===Ou(u)?_e(u):ut}),xf=function(n){return s(uu,Xe,_e(Re(n)))},Bf=e(function(n,r){var t=xf(s(jf,1,n)),e=C(t,ut)?n:s(Rf,1,n),u=su(s(jf,2,e)),i=_e(s(Ef,cu,Re(s(Rf,2,e))));if("Nothing"===u.$)return ut;var o=u.a;return d(Pf,o,t,i,r)}),zf=o(function(n,r,t,e,u){if("Nothing"===t.$)return"Nothing"===e.$||C(o=e.a,Ki(Ei(u)));var i=t.a;if("Nothing"===e.$)return C(i,Di(Ei(u)));var o=e.a;return C(i,Di(Ei(u)))&&C(o,Ki(ji(u)))}),Ff=i(function(n,r,t,e){var u=Re(t),i=s(Ef,cu,u),o=s(Ef,vu,u);if(Ou(i)>1||Ou(o)>1)return ut;var a=_e(o),f=_e(i),c=s(Oe,d(zf,n,r,f,a),l(Ua,n,r,e));return 1===Ou(c)?_e(c):ut}),Jf=e(function(n,r){var t=su(s(jf,2,n)),e=xf(n),u=s(Rf,2,s(fu,1,n));if("Nothing"===e.$)return ut;var i=e.a;if("Nothing"===t.$)return ut;var o=t.a;return d(Ff,i,o,u,r)}),Df=e(function(n,r){var t,e=s(If,_f,n);return"O-O"===e?function(n){return _e(s(Oe,qi,yf(n)))}(r):"O-O-O"===e?function(n){return _e(s(Oe,Pi,yf(n)))}(r):(t=s(Of,1,e),s("N"===t||"B"===t||"R"===t||"Q"===t||"K"===t?Jf:Bf,e,r))}),Kf=e(function(n,r){n:for(;;)switch(n.$){case"JsPort":var t=n.a,e=s(Af,ii,t);if("Ok"===e.$){n=e.a,r=r;continue n}var u=e.a;return P(z(r,{error:Ae(zu(u))}),li);case"SetOtherId":return P(z(r,{otherId:n.a}),li);case"Connect":return P(r,gu(fi(G([P("type",ci("Connect")),P("otherId",ci(r.otherId))]))));case"SquarePressed":var i=n.a;return s(Tf,i,r);case"GotId":var o=n.a;return P(z(r,{myId:Ae(o)}),li);case"Ready":return P(z(r,{gameState:Gu}),vi(G([P("type",ci("Ready2"))])));case"Ready2":return P(z(r,{gameState:Qu,isBlack:!0}),li);case"GotMove":var a=n.a,f=s(Df,a,_o(r.game));if("Just"===f.$){var c=f.a;return P(z(r,{candidateMoves:J,game:s(Oo,c,r.game),gameState:Gu,selectedSquare:ut}),li)}return P(r,li);case"Rematch":return P(ai(r),vi(G([P("type",ci("Rematch"))])));default:return P(ai(r),li)}}),Gf={$:"Connect"},Qf=function(n){return{$:"SetOtherId",a:n}},Uf={$:"Rematch"},Yf=vn,Wf=function(n){return Yf(n)+"px"},Vf=function(n){return n.toLowerCase()},Hf=zi,Xf=ho,Zf=s(po,function(n){return C(n,Ne)?B("w"):C(n,Ke)?B("b"):B("-")},Ro),nc=qo,rc=function(n){return"http://res.cloudinary.com/ds1kquy7j/image/upload/"+Zf(Hf(n))+Vf(nc(Xf(n)))+".png"},tc=mn,ec=function(n){switch(n.$){case"Normal":return 0;case"MayStopPropagation":return 1;case"MayPreventDefault":return 2;default:return 3}},uc=ir("div"),ic=ur,oc=fr,ac=ar,fc=e(function(n,r){return s(ac,n,{$:"Normal",a:r})}),cc=function(n){return s(fc,"click",ei(n))},vc=i(function(n,r,t,e){var u=n.a,i=n.b;return s(uc,G([cc(e),s(oc,"backgroundColor",s(Be,2,u+i)?"rgb(140, 140, 140)":"rgb(200, 200, 200)"),s(oc,"position","absolute"),s(oc,"top",Wf(i*t)),s(oc,"left",Wf(u*t)),s(oc,"width",Wf(t)),s(oc,"height",Wf(t))]),G([function(){if("Nothing"===r.$)return ic("");var n,e=r.a;return s(uc,G([s(oc,"position","absolute"),s(oc,"width",Wf(t)),s(oc,"height",Wf(t)),s(oc,"backgroundImage",(n=rc(e),"url("+n+")")),s(oc,"backgroundSize",Wf(t)+" "+Wf(t))]),J)}()]))}),sc=Di,lc=Ki,dc=function(n){return ve(n)-1},bc=function(n){return se(n)-2},hc=e(function(n,r){return P(r?7-dc(sc(n)):dc(sc(n)),r?bc(lc(n)):7-bc(lc(n)))}),gc=ir("b"),pc=ir("button"),mc=Ke,$c=wf,yc=e(function(n,r){var t=s(wo,n,r);return C(t,re)||C(t,ee)?ut:Ae(t)}),wc=Aa,Sc=$e,kc=i(function(n,r,t,e){return s(uc,J,G([s(uc,G([s(oc,"width",Wf(t)),s(oc,"height",Wf(t)),s(oc,"position","relative"),s(oc,"marginLeft","auto"),s(oc,"marginRight","auto")]),s(ae,function(n){return d(vc,s(hc,n,e),s(yc,n,r),t/8,{$:"SquarePressed",a:n})},Sc)),function(){if($c(r)){var t=C(wc(r),mc)&&n?"You lose!":"You win!";return s(uc,J,G([s(gc,J,G([ic("Checkmate! "+t)])),s(pc,G([cc(Uf)]),G([ic("Rematch")]))]))}return ic("")}()]))}),Nc=ir("input"),Lc=An,Mc=e(function(n,r){return s(cr,n,Lc(r))})("readOnly"),Tc=e(function(n,r){return s(cr,n,ci(r))})("value"),Ac=function(n){return P(n,!0)},Ic=e(function(n,r){return s(ac,n,{$:"MayStopPropagation",a:r})}),Oc=s(e(function(n,r){return l(ie,ni,r,n)}),G(["target","value"]),ti),_c=function(n){return{$:"NotFound",a:n}},Cc=function(n){for(;;){n=n.a}},Ec=function(n){return{$:"Perform",a:n}},Rc=_n,jc=Rc(q),qc=En,Pc=e(function(n,r){return s(qc,function(r){return Rc(n(r))},r)}),xc=u(function(n,r,t){return s(qc,function(r){return s(qc,function(t){return Rc(s(n,r,t))},t)},r)}),Bc=Qn,zc=e(function(n,r){var t=r.a;return qn(s(qc,Bc(n),t))}),Fc=u(function(n,r,t){return s(Pc,function(n){return q},(e=s(ae,zc(n),r),l(ie,xc(ct),Rc(J),e)));var e}),Jc=u(function(n,r,t){return Rc(q)}),Dc=e(function(n,r){var t=r.a;return Ec(s(Pc,n,t))});Kn.Task={b:jc,c:Fc,d:Jc,e:Dc,f:tt};var Kc,Gc=Un("Task"),Qc=e(function(n,r){return Gc(Ec(s(Pc,n,r)))}),Uc=cn,Yc=function(n){return""===n},Wc=fn,Vc=function(n){for(var r=0,t=n.charCodeAt(0),e=43==t||45==t?1:0,u=e;u<n.length;++u){var i=n.charCodeAt(u);if(i<48||57<i)return ut;r=10*r+i-48}return u==e?ut:Ae(45==t?-r:r)},Hc=a(function(n,r,t,e,u,i){return{fragment:i,host:r,path:e,port_:t,protocol:n,query:u}}),Xc=o(function(n,r,t,e,u){if(Yc(u)||s(Wc,"@",u))return ut;var i=s(Uc,":",u);if(i.b){if(i.b.b)return ut;var o=i.a,a=Vc(s(fu,o+1,u));if("Nothing"===a.$)return ut;var f=a;return Ae(h(Hc,n,s(Of,o,u),f,r,t,e))}return Ae(h(Hc,n,u,ut,r,t,e))}),Zc=i(function(n,r,t,e){if(Yc(e))return ut;var u=s(Uc,"/",e);if(u.b){var i=u.a;return b(Xc,n,s(fu,i,e),r,t,s(Of,i,e))}return b(Xc,n,"/",r,t,e)}),nv=u(function(n,r,t){if(Yc(t))return ut;var e=s(Uc,"?",t);if(e.b){var u=e.a;return d(Zc,n,Ae(s(fu,u+1,t)),r,s(Of,u,t))}return d(Zc,n,ut,r,t)}),rv=(e(function(n,r){if(Yc(r))return ut;var t=s(Uc,"#",r);if(t.b){var e=t.a;return l(nv,n,Ae(s(fu,e+1,r)),s(Of,e,r))}return l(nv,n,ut,r)}),Br({init:function(n){return P(hu,gu(Ju(57)))},subscriptions:function(n){return Ku(et)},update:Kf,view:function(n){return s(uc,J,G([s(uc,J,G([ic("my id"),s(Nc,G([Mc(!0),Tc(s(Pt,"",n.myId))]),J)])),ic("other id"),function(){var r=n.error;if("Nothing"===r.$)return ic("");var t=r.a;return s(uc,J,G([s(gc,J,G([ic(t)]))]))}(),s(Nc,G([Tc(n.otherId),(r=Qf,s(Ic,"input",s(ri,Ac,s(ri,r,Oc))))]),J),s(pc,G([cc(Gf)]),G([ic("Connect")])),function(){switch(n.gameState.$){case"Init":return s(uc,J,G([ic("Waiting for other player")]));case"MyTurn":return s(uc,J,G([d(kc,n.isBlack,_o(n.game),400,n.isBlack)]));default:return s(uc,J,G([d(kc,n.isBlack,_o(n.game),400,n.isBlack),ic("Wait for other player to make a move")]))}}()]));var r}}));Kc={Main:{init:rv(ei(q))(0)}},r.Elm?function n(r,t,e){for(var u in e)u in t?"init"==u?O(6,r):n(r+"."+u,t[u],e[u]):t[u]=e[u]}("Elm",r.Elm,Kc):r.Elm=Kc}(this);
},{}],"Focm":[function(require,module,exports) {
"use strict";var n=e(require("peerjs")),o=require("./dist/elm.js");function e(n){return n&&n.__esModule?n:{default:n}}var t=o.Elm.Main.init({node:document.getElementById("main")}),c=new n.default({debug:2});c.on("open",function(n){t.ports.input.send({type:"GotId",id:n}),console.log("open",n)}),c.on("connection",function(n){console.log("connection",n),window.conn=n,window.conn.on("data",function(n){console.log("Received",n),t.ports.input.send({type:"GotMsg",data:n})}),setTimeout(function(){return n.send({type:"Ready"})},1e3)}),c.on("disconnected",function(n){console.log("disconnected",n)}),c.on("close",function(n){console.log("close",n)}),c.on("error",function(n){console.log("error",n)}),t.ports.output.subscribe(function(n){console.log("elm data",n),"Connect"===n.type?(window.conn=c.connect(n.otherId),window.conn.on("data",function(n){console.log("Received",n),t.ports.input.send({type:"GotMsg",data:n})})):"Send"===n.type&&window.conn.send(n.data)});
},{"peerjs":"L0SA","./dist/elm.js":"5lnN"}]},{},["Focm"], null)
//# sourceMappingURL=/p2pc.77a62c10.map